"use strict";(self.webpackChunkgalaxy_web=self.webpackChunkgalaxy_web||[]).push([[6508],{36508:(e,t,o)=>{o.r(t),o.d(t,{default:()=>Q});var l=o(65043),i=o(28076),n=o(39652),s=o(77502),a=o(96446),d=o(68903),r=o(85865),c=o(79650),u=o(63336),p=o(71806),m=o(84882),v=o(73460),x=o(54620),g=o(45903),h=o(73216),f=o(77020),y=o(23602),A=o(44563),j=(o(36838),o(42165),o(66535),o(85900)),b=o(83992),S=o(91395),C=o(22030),w=o(20566),_=o(24858),k=o(79456),D=o(4841),N=o(29542),F=o(91284),z=o(37230),P=(o(72450),o(86005)),R=o(86178),U=o.n(R),E=(o(54667),o(99543)),T=o(95692),Y=o(87383),I=o(93445),W=o(70255),M=o(21727),q=(o(18285),o(88073)),L=o(50857),V=o(23768),$=o(19668),B=o(28153),O=o(91973),K=o(70579);const H=(0,g.A)(i.A)((e=>{let{theme:t}=e;return{border:0}})),J=(0,g.A)(n.A)((e=>{let{theme:t}=e;return{[`&.${s.A.head}`]:{fontSize:14,fontFamily:"Public Sans",border:"1px solid #EEEEEE",padding:"15px",textAlign:"left",whiteSpace:"nowrap",color:"#434343",paddingRight:"50px",background:"transparent",fontWeight:"bold"},[`&.${s.A.body}`]:{fontSize:14,fontFamily:"Public Sans",textWrap:"nowrap",padding:"5px !important",paddingLeft:"15px !important",".MuiBox-root":{display:"flex",gap:"6px",alignItems:"center",justifyContent:"center",".MuiBox-root":{cursor:"pointer"}},svg:{width:"auto",height:"24px"},".MuiTypography-root":{textTransform:"capitalize",fontFamily:x.ay.NunitoRegular,textWrap:"nowrap"},".MuiButtonBase-root":{padding:"8px",width:"28px",height:"28px"}}}})),X=(0,b.A)({loaderWrap:{display:"flex",height:100,"& svg":{width:"40px !important",height:"40px !important"}}});const Q=function(){var e,t,o,i,n,s,g,b,R,Q,Z,G,ee;const te=["text/csv"],{state:oe}=(0,h.zy)(),{user:le,userLogout:ie}=(0,$.A)();console.log(le);const{register:ne,handleSubmit:se,getValues:ae,setValue:de,formState:{errors:re}}=(0,_.mN)(),{register:ce,handleSubmit:ue,setValue:pe,getValues:me,reset:ve,formState:{errors:xe}}=(0,_.mN)(),{register:ge,handleSubmit:he,setValue:fe,getValues:ye,formState:{errors:Ae}}=(0,_.mN)(),{register:je,handleSubmit:be,setValue:Se,getValues:Ce,formState:{errors:we}}=(0,_.mN)(),_e=(0,h.Zp)(),ke=(X(),(0,k.wA)()),De=(0,l.useRef)(null),[Ne,Fe]=(0,l.useState)(!1),[ze,Pe]=(0,l.useState)(!1),[Re,Ue]=(0,l.useState)(null),[Ee,Te]=(0,l.useState)([]),[Ye,Ie]=(0,l.useState)(!1),[We,Me]=(0,l.useState)("asc"),[qe,Le]=(0,l.useState)([]),[Ve,$e]=(0,l.useState)(0),[Be,Oe]=(0,l.useState)(50),[Ke,He]=(0,l.useState)(1),[Je,Xe]=(0,l.useState)(null),[Qe,Ze]=(0,l.useState)(0),[Ge,et]=(0,l.useState)(),[tt,ot]=(0,l.useState)(),[lt,it]=(0,l.useState)(null),[nt,st]=(0,l.useState)(null),[at,dt]=(0,l.useState)(null),[rt,ct]=(0,l.useState)(null),[ut,pt]=(0,l.useState)([]),[mt,vt]=(0,l.useState)(!1),[xt,gt]=(0,l.useState)(null),[ht,ft]=(0,l.useState)(),[yt,At]=(0,l.useState)(!1),[jt,bt]=(0,l.useState)(0),[St,Ct]=(0,l.useState)(0),[wt,_t]=(0,l.useState)(),[kt,Dt]=(0,l.useState)(),[Nt,Ft]=(0,l.useState)(),[zt,Pt]=(0,l.useState)(),[Rt,Ut]=(0,l.useState)([]),[Et,Tt]=(0,l.useState)(!1),[Yt,It]=(0,l.useState)(),[Wt,Mt]=(0,l.useState)(null),[qt,Lt]=(0,l.useState)(null),[Vt,$t]=(0,l.useState)(!1),[Bt,Ot]=(0,l.useState)([]),[Kt,Ht]=(0,l.useState)(!1),[Jt,Xt]=(0,l.useState)(null),[Qt,Zt]=(0,l.useState)(!1),[Gt,eo]=(0,l.useState)(null),[to,oo]=(0,l.useState)(null),[lo,io]=(0,l.useState)(null),[no,so]=(0,l.useState)({}),[ao,ro]=(0,l.useState)(),[co,uo]=(0,l.useState)(!1),po=async(e,t)=>{bt(0);try{const i=new FormData;i.append("document",e),console.log(e);const{data:n}=await q.A.post(L.A.uploadDocuments,i,{onUploadProgress:e=>{const t=e.loaded,o=Math.round(100*t/e.total);bt(o),console.log((0,C.KU)(t)),Ct((0,C.KU)(t))}});var o,l;if(n)return t[0].isUpload=!0,t[0].file=null===n||void 0===n||null===(o=n.data)||void 0===o?void 0:o.nations,console.log(n,"asddasasd"),null===n||void 0===n||null===(l=n.data)||void 0===l?void 0:l.path}catch(i){(0,A.LY)(i)}},mo=async(e,t,o)=>{try{const l=e||Ke,i=t||Be,n=o?{...no,...o}:null;He(l),Oe(i),so(n);let s={page:l,limit:i,admin_approval_required:!0,customer_id:"C"==(null===le||void 0===le?void 0:le.user_type)?null===le||void 0===le?void 0:le.customer_id:null};s={...s,...n},console.log(s,"params");const{data:a}=await Y.A.getVisaRequestList(s);Te(null===a||void 0===a?void 0:a.rows),$e(null===a||void 0===a?void 0:a.count),console.log((0,C.TJ)(null===a||void 0===a?void 0:a.permissions)),ro((0,C.TJ)(null===a||void 0===a?void 0:a.permissions)),ro((0,C.TJ)(null===a||void 0===a?void 0:a.permissions)),null===a||void 0===a||a.permissions.forEach((e=>{null!==e&&void 0!==e&&e.route&&null!==e&&void 0!==e&&e.identifier&&null!==e&&void 0!==e&&e.permitted&&ke((0,D.Ft)(null===e||void 0===e?void 0:e.route))}))}catch(l){(0,T.Ni)(l)}},vo=async(e,t,o,l)=>{try{const l=e||Ke,i=t||Be,n={...no,...o};He(l),Oe(i),so(n);let s={page:l,limit:1,customer_id:"C"==(null===le||void 0===le?void 0:le.user_type)?null===le||void 0===le?void 0:le.customer_id:null===Wt||void 0===Wt?void 0:Wt.id};s={...s,...n};const{data:a}=await j.A.checkWPS(s);Ht(null===a||void 0===a?void 0:a.wpsRequired),console.log(a),null!==a&&void 0!==a&&a.wpsRequired?(0,T.Ni)("You have to create WPS first"):(async()=>{bt(0);let e=Nt;console.log(Wt,"asdasdas");try{const l=new FormData;l.append("file",wt),l.append("id","C"==(null===le||void 0===le?void 0:le.user_type)?null===Wt||void 0===Wt?void 0:Wt.customer_id:null===Wt||void 0===Wt?void 0:Wt.id),console.log(wt);let i=10485760;if(wt.size>i)return void(0,T.Ni)("File Size Must Be Less than 10 MB");const{data:n}=await q.A.post(L.A.uploadCVS,l,{onUploadProgress:e=>{const t=e.loaded,o=Math.round(100*t/e.total);bt(o),Ct((0,C.KU)(t)),console.log((0,C.KU)(t))}});var t,o;if(200===(null===n||void 0===n?void 0:n.responseCode))return e[0].isUpload=!0,e[0].file=null===n||void 0===n||null===(t=n.data)||void 0===t?void 0:t.nations,console.log(n,"Upload successful"),V.Ay.success("Successfully Updated!"),ft(!1),vt(!1),Dt(""),null===n||void 0===n||null===(o=n.data)||void 0===o?void 0:o.path;console.log("asdasasdasdasdasdad"),Dt(""),ft(!1),vt(!1),(0,T.Ni)((null===n||void 0===n?void 0:n.message)||"An error occurred during upload.")}catch(n){var l,i;console.error("Upload error:",n),Dt(""),ft(!1),vt(!1),(0,T.Ni)((null===(l=n.response)||void 0===l||null===(i=l.data)||void 0===i?void 0:i.message)||"Something went wrong, please try again.")}})()}catch(i){(0,T.Ni)(i)}},xo=async(e,t)=>{try{let t={customer_id:e};if(e){var o;const{data:l}=await j.A.getCustomerDetail(t);console.log(null===l||void 0===l||null===(o=l.details)||void 0===o?void 0:o.security_deposit_scenario),go(1,1,{},e),Xt(null===l||void 0===l?void 0:l.details)}}catch(l){(0,T.Ni)(l)}},go=async(e,t,o,l)=>{try{var i;let e={page:1,limit:1,customer_id:"C"==(null===le||void 0===le?void 0:le.user_type)?null===le||void 0===le?void 0:le.customer_id:l};const{data:t}=await j.A.getWPSList(e);if(Ot(null===t||void 0===t?void 0:t.rows[0]),(null===t||void 0===t||null===(i=t.rows)||void 0===i?void 0:i.length)>0){var n;let e=U()(null===t||void 0===t||null===(n=t.rows[0])||void 0===n?void 0:n.date).startOf("month"),o=U()().startOf("month").diff(e,"months");console.log(o,"diff"),Ht(o<=1)}else Ht(!0)}catch(s){(0,T.Ni)(s)}};return(0,l.useEffect)((()=>{if((async()=>{try{const{data:e}=await W.A.getBanks();pt(null===e||void 0===e?void 0:e.banks)}catch(e){(0,T.Ni)(e)}})(),(async(e,t,o)=>{try{var l;const i=e||Ke,n=t||Be,s={...no,...o};He(i),Oe(n),so(s);let a={page:1,limit:1e3};a={...a,...s};const{data:d}=await j.A.getCustomerQueue(a);console.log(null===d||void 0===d||null===(l=d.rows)||void 0===l?void 0:l.length),Le(null===d||void 0===d?void 0:d.rows)}catch(i){(0,T.Ni)(i)}})(),"C"==(null===le||void 0===le?void 0:le.user_type)&&(console.log(le,"user"),fe("customer",le),Mt(le),xo(null===le||void 0===le?void 0:le.customer_id)),oe){console.log(oe),mo(1,"",{approval_status:oe})}else mo()}),[]),(0,K.jsxs)(a.A,{sx:{p:3},children:[(0,K.jsx)(N.A,{open:Et,onClose:()=>{Ut([]),Tt(!1),ve(),It("")},title:"Proof Of Payment",children:yt?(0,K.jsx)(a.A,{children:(0,K.jsxs)(d.Ay,{container:!0,spacing:2,children:[(0,K.jsx)(d.Ay,{container:!0,children:(0,K.jsxs)(r.A,{sx:{fontSize:"18px",fontWeight:"bold",color:f.A.gray,mt:1},children:["Upload Proof : "," "]})}),(0,K.jsx)(d.Ay,{container:!0,children:null===Rt||void 0===Rt?void 0:Rt.map(((e,t)=>(0,K.jsxs)(d.Ay,{item:!0,md:6,lg:6,sx:{cursor:"pointer",display:"flex",gap:"5px",alignItems:"center"},component:"div",onClick:()=>{console.log("https://pro.mangotech-api.com/"),console.log(e.trim());const t=e.trim().split("_").pop();null!==t&&void 0!==t&&t.includes("doc")||null!==t&&void 0!==t&&t.includes("xls")?(0,C.h1)(e.trim(),t||""):window.open("https://pro.mangotech-api.com/"+e.trim(),"_blank")},children:[console.log(Rt),e&&(0,K.jsx)(a.A,{children:(0,K.jsx)(a.A,{component:"img",src:x.To.docIcon,alt:"Document Icon",width:35,height:35})}),(0,K.jsx)("p",{style:{textAlign:"center",lineHeight:"20px",color:"#0F2772",fontWeight:"bold",fontSize:"15px"},children:e.trim().split("_").pop()})]},t)))}),(0,K.jsx)(d.Ay,{item:!0,xs:12,sm:12,children:(0,K.jsx)(E.A,{value:null===Je||void 0===Je?void 0:Je.proof_amount,label:"Amount : ",StartLabel:"AED",disabled:!0,register:je("amount",{required:"Enter  amount"})})}),(0,K.jsx)(d.Ay,{item:!0,xs:12,sm:12,children:(0,K.jsx)(w.A,{label:"Date :",size:"small",disabled:!0,value:U()(null===Je||void 0===Je?void 0:Je.proof_date).format("MM-DD-YYYY"),rows:5,placeholder:"Description",error:null===xe||void 0===xe||null===(o=xe.description)||void 0===o?void 0:o.message,register:ce("description",{required:!1})})})]})}):(0,K.jsx)(a.A,{component:"form",onSubmit:be((async e=>{try{let t={proof_date:lt,id:null===Je||void 0===Je?void 0:Je.id,proof_document:Yt,proof_amount:null===e||void 0===e?void 0:e.amount};const o=Y.A.UpdateProof(t);console.log(o),(0,T.y8)(o,"Saving...","Added Successfully","Something Went Wrong");const l=await o;200===(null===l||void 0===l?void 0:l.responseCode)&&(Tt(!1),mo(),ve(),It(""))}catch(t){console.log(t)}})),children:(0,K.jsxs)(d.Ay,{container:!0,spacing:2,children:[(0,K.jsxs)(d.Ay,{item:!0,xs:12,children:[(0,K.jsxs)(r.A,{sx:{fontSize:"18px",fontWeight:"bold",color:f.A.gray,mt:1},children:["Upload Proof :*"," "]}),(0,K.jsx)(O.A,{Memo:!0,updateResult:(e,t)=>{console.log(t,"newResult"),It(t)},multiple:!0,accept:["image/png","image/jpg","image/jpeg","application/pdf","application/vnd.ms-excel","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],error:null===we||void 0===we||null===(e=we.proof)||void 0===e?void 0:e.message,file:Yt,register:je("proof",{required:"Please upload  proof   .",onChange:async e=>{const t=await(async e=>{try{e.preventDefault();const t=Array.from(e.target.files),o=10485760,l=["image/jpeg","image/png","application/pdf"],i=t.map((async e=>{if(e.size>o)return(0,T.Ni)(`File ${e.name} is larger than 10 MB`),null;if(!l.includes(e.type))return(0,T.Ni)(`File ${e.name} is not of an allowed type`),null;const t={name:e.name,file:"",type:e.type.split("/")[1],size:(0,C.KU)(e.size),isUpload:!1};try{return await po(e,[t])}catch(i){return(0,T.Ni)(`Failed to upload ${e.name}: ${i.message}`),null}})),n=(await Promise.all(i)).filter((e=>null!==e));if(0===n.length)return(0,T.Ni)("No files were successfully uploaded"),"";const s=n.join(",");return console.log("Uploaded file paths:",s),s}catch(t){return(0,A.LY)(t.message||"An error occurred during file upload"),""}})(e);t&&It(t)}})})]}),(0,K.jsx)(d.Ay,{item:!0,xs:12,sm:12,children:(0,K.jsx)(E.A,{label:"Amount : ",disabled:!0,StartLabel:"AED",register:je("amount",{required:"Enter  amount"})})}),(0,K.jsx)(d.Ay,{item:!0,xs:12,sm:12,children:(0,K.jsx)(I.A,{label:"Payment Date :",value:lt,size:"small",error:null===we||void 0===we||null===(t=we.date)||void 0===t?void 0:t.message,register:je("date",{required:"Please enter  date."}),onChange:e=>{(e=>{try{if("Invalid Date"==e)return void it("invalid");it(new Date(e))}catch(t){(0,A.LY)(t)}})(e),Se("date",e)}})}),(0,K.jsx)(d.Ay,{container:!0,sx:{justifyContent:"center"},children:(0,K.jsxs)(d.Ay,{item:!0,xs:6,sm:6,sx:{mt:2,display:"flex",justifyContent:"space-between",gap:"25px"},children:[(0,K.jsx)(F.jn,{bgcolor:f.A.primary,title:"Yes,Confirm",type:"submit"}),(0,K.jsx)(F.jn,{onClick:()=>{Tt(!1),ve(),It("")},bgcolor:"#FF1F25",title:"No,Cancel"})]})})]})})}),(0,K.jsx)(N.A,{open:mt,onClose:()=>vt(!1),title:"Upload Excel",children:(0,K.jsx)(a.A,{component:"form",onSubmit:he((async()=>{vo()})),children:(0,K.jsxs)(d.Ay,{container:!0,spacing:2,children:[(0,K.jsx)(d.Ay,{item:!0,xs:12,sm:12,display:"flex",justifyContent:"center",children:(0,K.jsx)(F.jn,{bgcolor:"#0076bf",title:"Download Template",onClick:()=>{fetch(M).then((e=>e.blob())).then((e=>{console.log(e);const t=window.URL.createObjectURL(new Blob([e])),o=document.createElement("a");o.href=t,o.setAttribute("download","Format.csv"),document.body.appendChild(o),o.click(),o.parentNode.removeChild(o)})).catch((e=>console.error("Error downloading Excel file:",e)))},loading:co})}),(0,K.jsx)(d.Ay,{item:!0,xs:12,children:(0,K.jsx)(z.A,{size:"small",label:"Select Customer :",options:qe,disabled:"C"==(null===le||void 0===le?void 0:le.user_type),selected:Wt,onSelect:e=>{Mt(e),xo(null===e||void 0===e?void 0:e.id),fe("customer",e)},error:null===Ae||void 0===Ae||null===(i=Ae.customer)||void 0===i?void 0:i.message,register:ge("customer",{required:"Please select customer account."})})}),Wt&&(0,K.jsxs)(d.Ay,{item:!0,xs:5,children:[(0,K.jsx)(r.A,{sx:{fontSize:"18px",fontWeight:"bold",color:f.A.gray,mt:1},children:"Upload CSV :* "}),(0,K.jsx)(B.A,{Memo:!0,accept:te,error:null===Ae||void 0===Ae||null===(n=Ae.excel)||void 0===n?void 0:n.message,disabled:Qt,register:ge("excel",{required:"Please upload  excel   .",onChange:async e=>{Zt(!0),(async e=>{try{if(console.log(e.target.files,"e.target.files"),e.target.files.length>0){e.preventDefault();const t=e.target.files[0];let o=[{name:null===t||void 0===t?void 0:t.name,file:"",type:null===t||void 0===t?void 0:t.type.split("/")[1],size:(0,C.KU)(t.size),isUpload:!1}];te.includes(t.type)?(_t(t),Ft(o),Zt(!1)):(0,T.Ni)(`Only ${(0,C.zc)(te)} formats is supported`)}}catch(t){(0,T.Ni)(t)}})(e);const t=e.target.files[0];console.log(t),Dt(null===t||void 0===t?void 0:t.name),ft(t)}})}),console.log(null===ht||void 0===ht?void 0:ht.name,"asdasdasdasd"),(null===ht||void 0===ht?void 0:ht.name)&&(0,K.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,K.jsx)(a.A,{component:"img",src:x.To.uploadXls,width:"50px"}),(0,K.jsx)("span",{style:{color:"blue"},children:kt})," "]})]}),(0,K.jsx)(d.Ay,{container:!0,sx:{justifyContent:"center"},children:(0,K.jsxs)(d.Ay,{item:!0,xs:6,sm:6,sx:{mt:2,display:"flex",justifyContent:"space-between",gap:"25px"},children:[(0,K.jsx)(F.jn,{className:"disbaledClass",bgcolor:f.A.primary,title:"Yes,Confirm",type:"submit"}),(0,K.jsx)(F.jn,{onClick:()=>{vt(!1),ft(!1),Mt(null)},bgcolor:"#FF1F25",title:"No,Cancel"})]})})]})})}),(0,K.jsx)(N.A,{open:Ne,onClose:()=>Fe(!1),title:"Change Status?",children:(0,K.jsx)(a.A,{component:"form",onSubmit:se((async()=>{try{let e={status:tt.id,visa_id:null===Je||void 0===Je?void 0:Je.id};const t=Y.A.updateStatus(e);console.log(t),(0,T.y8)(t,"Saving...","Added Successfully","Something Went Wrong");const o=await t;200===(null===o||void 0===o?void 0:o.responseCode)&&(Fe(!1),mo())}catch(e){console.log(e)}})),children:(0,K.jsxs)(d.Ay,{container:!0,spacing:2,children:[(0,K.jsx)(d.Ay,{item:!0,xs:12,sm:12,children:(0,K.jsx)(z.A,{size:"small",label:"Select Status :",options:[{id:"Pending",name:"Pending"},{id:"Approved",name:"Approved"},{id:"Rejected",name:"Rejected"}],selected:tt,onSelect:e=>{ot(e)},error:null===re||void 0===re||null===(s=re.status)||void 0===s?void 0:s.message,register:ne("status",{required:"Please select status."})})}),(0,K.jsx)(d.Ay,{container:!0,sx:{justifyContent:"center"},children:(0,K.jsxs)(d.Ay,{item:!0,xs:6,sm:6,sx:{mt:2,display:"flex",justifyContent:"space-between",gap:"25px"},children:[(0,K.jsx)(F.jn,{bgcolor:f.A.primary,title:"Yes,Confirm",type:"submit"}),(0,K.jsx)(F.jn,{onClick:()=>Fe(!1),bgcolor:"#FF1F25",title:"No,Cancel"})]})})]})})}),(0,K.jsx)(N.A,{open:ze,onClose:()=>Pe(!1),title:"Change Approval Status?",children:(0,K.jsx)(a.A,{component:"form",onSubmit:ue((async e=>{$t(!0);parseFloat(.05*parseFloat(null===e||void 0===e?void 0:e.amount)+parseFloat(null===e||void 0===e?void 0:e.amount)).toFixed(2);try{let t={id:null===Je||void 0===Je?void 0:Je.id,customer_id:null===Je||void 0===Je?void 0:Je.customer_id,admin_approved:null===Re||void 0===Re?void 0:Re.id,admin_reason:null===e||void 0===e?void 0:e.reason};const o=Y.A.UpdateApprovalStatus(t);console.log(o),(0,T.y8)(o,"Saving...","Added Successfully","Something Went Wrong");const l=await o;200===(null===l||void 0===l?void 0:l.responseCode)&&(Pe(!1),mo(),ve(),$t(!1))}catch(t){console.log(t)}})),children:(0,K.jsxs)(d.Ay,{container:!0,children:[(0,K.jsx)(d.Ay,{item:!0,xs:12,sm:12,children:(0,K.jsx)(z.A,{size:"small",label:"Approval Status :",options:[{id:!0,name:"Approved"},{id:!1,name:"Rejected"}],selected:Re,onSelect:e=>{Ue(e)},error:null===xe||void 0===xe||null===(g=xe.status)||void 0===g?void 0:g.message,register:ce("status",{required:"Please select status."})})}),(0,K.jsx)(d.Ay,{item:!0,xs:12,sm:12,mt:2,children:(0,K.jsx)(w.A,{label:"Reason :",size:"small",placeholder:"Reason",error:null===xe||void 0===xe||null===(b=xe.reason)||void 0===b?void 0:b.message,register:ce("reason",{required:!1})})}),(0,K.jsx)(d.Ay,{container:!0,sx:{justifyContent:"center"},children:(0,K.jsxs)(d.Ay,{item:!0,xs:6,sm:6,sx:{mt:2,display:"flex",justifyContent:"space-between",gap:"25px"},children:[(0,K.jsx)(F.jn,{disabled:Vt,bgcolor:f.A.primary,title:"Yes,Confirm",type:"submit"}),(0,K.jsx)(F.jn,{onClick:()=>Pe(!1),bgcolor:"#FF1F25",title:"No,Cancel"})]})})]})})}),(0,K.jsxs)(a.A,{sx:{display:"flex",justifyContent:"space-between",mb:2},children:[(0,K.jsx)(r.A,{sx:{fontSize:"24px",fontWeight:"bold"},children:"Admin Approval"}),(0,K.jsxs)(a.A,{sx:{display:"flex",gap:"5px"},children:[(null===ao||void 0===ao?void 0:ao.create)&&(0,K.jsx)(F.jn,{bgcolor:"#bd9b4a",title:"Create Request",onClick:()=>_e("/create-request"),loading:co}),(null===ao||void 0===ao?void 0:ao.excel)&&(0,K.jsx)(F.jn,{bgcolor:"#0076bf",title:"Import Via Excel",onClick:()=>{vt(!0),Mt(null),"C"==(null===le||void 0===le?void 0:le.user_type)&&(console.log(le,"user"),fe("customer",le),Mt(le),xo(null===le||void 0===le?void 0:le.customer_id))},loading:co})]})]}),(0,K.jsxs)(a.A,{children:[(0,K.jsxs)(d.Ay,{container:!0,spacing:2,children:[(0,K.jsx)(d.Ay,{item:!0,xs:2,children:(0,K.jsx)(w.A,{label:"Search :",size:"small",fullWidth:!0,placeholder:"Search",error:null===re||void 0===re||null===(R=re.search)||void 0===R?void 0:R.message,register:ne("search")})}),"C"!=(null===le||void 0===le?void 0:le.user_type)&&(0,K.jsx)(d.Ay,{item:!0,xs:2,children:(0,K.jsx)(z.A,{size:"small",label:"Select Customer :",options:qe,selected:qt,onSelect:e=>{Lt(e)},error:null===re||void 0===re||null===(Q=re.customer)||void 0===Q?void 0:Q.message,register:ne("customer")})}),(0,K.jsx)(d.Ay,{item:!0,xs:2,children:(0,K.jsx)(z.A,{size:"small",label:"Select Status :",options:[{id:"paid",name:"Paid"},{id:"unpaid",name:"Unpaid"}],selected:Gt,onSelect:e=>{eo(e)},error:null===re||void 0===re||null===(Z=re.status)||void 0===Z?void 0:Z.message,register:ne("status")})}),(0,K.jsx)(d.Ay,{item:!0,xs:3,children:(0,K.jsx)(I.A,{label:" From Date  :",value:to,size:"small",maxDate:new Date,error:null===re||void 0===re||null===(G=re.fromDate)||void 0===G?void 0:G.message,register:ne("fromDate"),onChange:e=>{(e=>{try{if("Invalid Date"==e)return void oo("invalid");oo(new Date(e))}catch(t){(0,A.LY)(t)}})(e),de("fromDate",e)}})}),(0,K.jsx)(d.Ay,{item:!0,xs:3,children:(0,K.jsx)(I.A,{label:" To Date  :",value:lo,maxDate:new Date,size:"small",minDate:new Date(to),error:null===re||void 0===re||null===(ee=re.toDate)||void 0===ee?void 0:ee.message,register:ne("toDate"),onChange:e=>{(e=>{try{if("Invalid Date"==e)return void io("invalid");io(new Date(e))}catch(t){(0,A.LY)(t)}})(e),de("toDate",e)}})})]}),(0,K.jsx)(d.Ay,{container:!0,spacing:2,justifyContent:"flex-end",children:(0,K.jsxs)(d.Ay,{item:!0,xs:2,display:"flex",justifyContent:"flex-end",gap:2,children:[(0,K.jsx)(F.jn,{bgcolor:"#0076bf",textcolor:f.A.white,title:"Reset",onClick:()=>{Lt(null),io(null),oo(null),eo(null),de("status",""),de("search",""),mo(1,"",null)},loading:co}),(0,K.jsx)(F.jn,{bgcolor:"#bd9b4a",title:"Search",onClick:()=>(()=>{let e={search:ae("search"),payment_status:null===Gt||void 0===Gt?void 0:Gt.id,customer_id:null===qt||void 0===qt?void 0:qt.id,from_date:to,to_date:lo};(0,C.S$)((()=>mo(1,"",e)))})(),loading:co})]})}),(0,K.jsx)(d.Ay,{item:!0,md:11,children:Ee&&(0,K.jsxs)(a.A,{children:[(0,K.jsx)(d.Ay,{container:!0,mb:2}),Ee&&(0,K.jsxs)(l.Fragment,{children:[(0,K.jsx)(P.X,{ref:De,landscape:!0,paperSize:"A4",margin:5,fileName:"Import Customers",children:(0,K.jsx)(c.A,{component:u.A,sx:{maxHeight:"calc(100vh - 200px)",mt:5,backgroundColor:"transparent",boxShadow:"none !important",borderRadius:"0px !important"},children:(0,K.jsxs)(p.A,{stickyHeader:!0,sx:{minWidth:500},children:[(0,K.jsx)(m.A,{children:(0,K.jsx)(H,{children:[{name:"VR ID.",key:""},{name:"Date",key:"created_at"},{name:"Customer",key:"created_at"},{name:"Visa Quantity",key:"commission_visa"},{name:"Total Amount",key:"commission_monthly"},{name:"VAT",key:""},{name:"Admin Approval Status",key:""},{name:"Status Change Date",key:"customerCount"},{name:"Reason",key:"customerCount"},{name:"Actions",key:""}].map(((e,t)=>(0,K.jsx)(J,{style:{textAlign:"SR No."==(null===e||void 0===e?void 0:e.name)?"center":"left",paddingRight:"SR No."==(null===e||void 0===e?void 0:e.name)?"15px":"50px"},className:"pdf-table",children:(0,K.jsxs)(a.A,{sx:{display:"flex",alignItems:"flex-end"},children:[null===e||void 0===e?void 0:e.name," ","Date"==(null===e||void 0===e?void 0:e.name)&&(0,K.jsxs)(K.Fragment,{children:["\xa0",(0,K.jsx)("span",{style:{height:"20px",cursor:"pointer"},children:(0,K.jsx)(a.A,{component:"img",onClick:()=>{Me("asc"==We?"desc":"asc"),(e=>{let t={sort_by:e,sort_order:We};(0,C.S$)((()=>mo(1,"",t)))})(null===e||void 0===e?void 0:e.key)},src:x.To.sortIcon,width:"18px"})})]})]})},t)))})}),(0,K.jsx)(v.A,{children:null===Ee||void 0===Ee?void 0:Ee.map(((e,t)=>{var o;return(0,K.jsxs)(H,{sx:{border:"1px solid #EEEEEE !important"},children:[(0,K.jsx)(J,{style:{textAlign:"left"},className:"pdf-table",children:null===e||void 0===e?void 0:e.id}),(0,K.jsx)(J,{style:{textAlign:"left"},className:"pdf-table",children:U()(null===e||void 0===e?void 0:e.created_at).format("MM-DD-YYYY")}),(0,K.jsx)(J,{style:{textAlign:"left"},className:"pdf-table",children:null===e||void 0===e||null===(o=e.customer)||void 0===o?void 0:o.name}),(0,K.jsx)(J,{style:{textAlign:"left"},className:"pdf-table",children:null===e||void 0===e?void 0:e.candidates_count}),(0,K.jsx)(J,{style:{textAlign:"left"},className:"pdf-table",children:null===e||void 0===e?void 0:e.total_visa_charges}),(0,K.jsx)(J,{style:{textAlign:"left"},className:"pdf-table",children:parseFloat(.05*parseFloat(null===e||void 0===e?void 0:e.total_visa_charges)).toFixed(2)}),(0,K.jsx)(J,{style:{textAlign:"left"},className:"pdf-table",children:(0,K.jsxs)(a.A,{component:"div",sx:{cursor:"pointer"},onClick:()=>{null==(null===e||void 0===e?void 0:e.admin_approved)&&"O"==(null===le||void 0===le?void 0:le.user_type)&&(it(null),ct(null),Pe(!0),Xe(e))},children:[(0,K.jsx)(a.A,{component:"img",src:1==(null===e||void 0===e?void 0:e.admin_approved)?x.To.successIcon:x.To.errorIcon,width:"13px"}),1==(null===e||void 0===e?void 0:e.admin_approved)?"Approved":0==(null===e||void 0===e?void 0:e.admin_approved)?"Rejected":"Pending"]})}),(0,K.jsx)(J,{style:{textAlign:"left"},className:"pdf-table",children:null!==e&&void 0!==e&&e.admin_status_change_at?U()(null===e||void 0===e?void 0:e.admin_status_change_at).format("MM-DD-YYYY"):"-"}),(0,K.jsx)(J,{style:{textAlign:"left"},className:"pdf-table",children:null!==e&&void 0!==e&&e.admin_reason?null===e||void 0===e?void 0:e.admin_reason:"-"}),(0,K.jsx)(J,{style:{textAlign:"left"},className:"pdf-table",children:(0,K.jsx)(a.A,{children:(0,K.jsx)(a.A,{component:"img",src:x.To.detailIcon,onClick:()=>_e(`/visa-detail/${null===e||void 0===e?void 0:e.id}`),width:"35px"})})})]},t)}))})]})})}),(0,K.jsx)(S.A,{currentPage:Ke,pageSize:Be,onPageSizeChange:e=>mo(1,e.target.value,no),tableCount:null===qe||void 0===qe?void 0:qe.length,totalCount:Ve,onPageChange:e=>mo(e,"",no)})]}),Ye&&(0,K.jsx)(y.$,{})]})})]})]})}},91973:(e,t,o)=>{o.d(t,{A:()=>f});var l=o(65043),i=o(96446),n=o(85865),s=o(81637),a=o(17392),d=o(83992),r=o(77020),c=o(54620),u=o(45903),p=o(63471),m=o(58613),v=o.n(m),x=o(70579);const g=(0,d.A)({root:{borderRadius:2,textAlign:"center",px:2,width:"220px",height:"120px",position:"relative",display:"flex",justifyContent:"center",alignItems:"center"}}),h=(0,u.A)("input")({position:"absolute",left:0,top:0,width:"100%",height:"100%",display:"block",opacity:0,fontSize:0,cursor:"pointer"});const f=function(e){let{inputRef:t,error:o,accept:d,register:u,multiple:m,style:f,custom:y,Memo:A,file:j,fileId:b,updateResult:S,disabled:C,loader:w}=e;const[_,k]=(0,l.useState)([]),D=g();return(0,l.useEffect)((()=>{v()("input.custom-file").prop("disabled",C),v()(".custom-file input").prop("disabled",C),v()(".custom-file button").prop("disabled",C)}),[C]),(0,l.useEffect)((()=>{if(j&&j.length>0){const e=j;if(console.log(e,"currentFile"),e){const t=e.split(",").map((e=>({extension:e.split(".").pop(),name:e.split("/").pop(),path:e.trim()})));console.log(t,"result"),k(t)}}}),[j,b]),(0,x.jsxs)(l.Fragment,{children:[(0,x.jsxs)(i.A,{style:f,className:D.root,children:[(0,x.jsx)(h,{className:"custom-file",disabled:C,ref:t,type:"file",multiple:m,accept:d,onChange:e=>{const t=Array.from(e.target.files).map((e=>({extension:e.name.split(".").pop(),name:e.name,path:URL.createObjectURL(e)}))),o=[..._,...t];k(o);const l=o.map((e=>e.path)).join(",");S(b,l)},...u,style:{width:"250px"}}),A&&(0,x.jsxs)(i.A,{sx:{fontSize:"15px"},children:[(0,x.jsx)(i.A,{sx:{textAlign:"left"},children:(0,x.jsx)(i.A,{component:"img",src:null===c.To||void 0===c.To?void 0:c.To.uploadDoc,width:"50px"})}),(0,x.jsxs)(n.A,{component:"h5",variant:"caption",sx:{color:r.A.black,mt:.2,textAlign:"center",fontSize:"15px",width:"223px"},children:[(0,x.jsx)("span",{style:{color:r.A.blue},children:"Click to Upload"})," Or drag & drop"]}),(0,x.jsx)(n.A,{component:"h5",variant:"caption",sx:{color:r.A.black,mt:.2,textAlign:"left",fontSize:"15px"},children:"(Max. File size: 10 MB)"})]})]}),(0,x.jsx)(i.A,{sx:{display:"flex",justifyContent:"space-between",gap:"2px",flexWrap:"wrap"},children:w?(0,x.jsx)(s.A,{}):_.length>0&&_.map(((e,t)=>(0,x.jsx)(i.A,{sx:{display:"flex",alignItems:"center",width:"35%"},children:(null===e||void 0===e?void 0:e.extension)&&(0,x.jsxs)(i.A,{sx:{position:"relative"},children:[(0,x.jsx)(i.A,{component:"div",onClick:()=>(e=>{const t=_.filter((t=>t.path!==e)),o=t.map((e=>e.path)).join(",");k(t),S(b,o)})(null===e||void 0===e?void 0:e.path),sx:{position:"absolute",top:-10,right:-10,cursor:"pointer"},children:(0,x.jsx)(a.A,{children:(0,x.jsx)(p.A,{})})}),(0,x.jsx)(i.A,{component:"img",sx:{cursor:"pointer"},onClick:()=>window.open("https://pro.mangotech-api.com/"+e.path,"_blank"),src:"png"===(null===e||void 0===e?void 0:e.extension)||"jpg"===(null===e||void 0===e?void 0:e.extension)||"jpeg"===(null===e||void 0===e?void 0:e.extension)?c.To.uploadImage:"pdf"===(null===e||void 0===e?void 0:e.extension)?c.To.uploadPDF:"xls"===(null===e||void 0===e?void 0:e.extension)?c.To.uploadXls:c.To.docIcon,width:"50px"}),(0,x.jsx)("p",{onClick:()=>window.open("https://pro.mangotech-api.com/"+e.path,"_blank"),style:{color:"blue",width:"120px",cursor:"pointer"},children:null===e||void 0===e?void 0:e.name})]})},t)))}),o&&(0,x.jsx)(n.A,{color:"error",sx:{fontSize:12,textAlign:"left"},children:o||"Please upload at least one file."})]})}}}]);
//# sourceMappingURL=6508.c8258582.chunk.js.map