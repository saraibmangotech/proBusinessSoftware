"use strict";(self.webpackChunkgalaxy_web=self.webpackChunkgalaxy_web||[]).push([[3561],{63561:(e,s,t)=>{t.r(s),t.d(s,{default:()=>I});var a=t(18285),o=t(96446),i=t(85865),l=t(68903),n=t(77020),r=t(93445),d=t(44563),p=t(88073),c=t(65043),m=t(24858),u=t(50857),g=t(22030),x=t(91284),y=t(54667),h=t(95692),v=t(20566),f=t(99543),A=t(73216),j=t(14398),b=t(85900),D=t(16819),S=t(86178),w=t.n(S),E=t(70579);const I=()=>{var e,s,t,S,I,k,C,L,M,P,_,q,z,Y,N,W,O;const[V,U]=(0,c.useState)(!0),R=["image/png","image/jpg","image/jpeg","application/pdf","application/vnd.ms-excel","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],[B]=(0,j.Z)(V),{register:$,handleSubmit:F,getValues:T,setValue:K,formState:{errors:Z},setError:G}=(0,m.mN)(),H=(0,A.Zp)(),[J,Q]=(0,c.useState)(0),[X,ee]=(0,c.useState)(0),[se,te]=(0,c.useState)(),[ae,oe]=(0,c.useState)(!1),[ie,le]=(0,c.useState)(),[ne,re]=(0,c.useState)(),[de,pe]=(0,c.useState)(),[ce,me]=(0,c.useState)(),[ue,ge]=(0,c.useState)(""),[xe,ye]=(0,c.useState)(!1),[he,ve]=(0,c.useState)(""),[fe,Ae]=(0,c.useState)(""),[je,be]=(0,c.useState)(""),[De,Se]=(0,c.useState)(!1),[we,Ee]=(0,c.useState)(!1),Ie=(e,s)=>{console.log(s);const t=Ce.map((t=>t.key===e?{...t,path:s}:t));console.log(t,"updatedDocuments"),Le(t)},ke=async(e,s,t)=>{if(console.log(Ce),"path"===e){const e=Ce.map((e=>e.key===t?{...e,path:s}:e));console.log(e),Le(e)}else{const e=Ce.map((e=>e.key===t?{...e,expiry_date:s}:e));console.log(e),Le(e)}},[Ce,Le]=(0,c.useState)([{name:"Trade License",key:"tradeLicense",path:"",expiry_date:null,is_required:!0},{name:"Passport",key:"passport",path:"",expiry_date:null,is_required:!0},{name:"Emirate Id's",key:"emirateIds",path:"",expiry_date:null,is_required:!0},{name:"Agreement",key:"Agreement",path:"",expiry_date:null,is_required:!0},{name:"Other doc",key:"otherdoc",path:"",expiry_date:null}]),Me=async(e,s)=>{oe(s);try{e.preventDefault();let s="";console.log(e.target.files,"length");const t=e.target;for(let a=0;a<e.target.files.length;a++){const t=e.target.files[a];let o=[{name:null===t||void 0===t?void 0:t.name,file:"",type:null===t||void 0===t?void 0:t.type.split("/")[1],size:(0,g.KU)(t.size),isUpload:!1}],i=10485760;if(t.size>i)(0,h.Ni)("File Size Must Be Less than 10 MB");else if(R.includes(t.type)){const e=`${(new Date).toISOString().split("T")[0]}_${t.name}`,a=new File([t],e,{type:t.type}),i=await Pe(a,o);s?s+=","+i:s=i,oe(!1)}else(0,h.Ni)(`File type ${t.type} is not allowed.`)}return console.log(s,"path"),t.value="",s}catch(t){(0,d.LY)(t)}},Pe=async(e,s)=>{Q(0);try{const o=new FormData;o.append("document",e),console.log(e);const{data:i}=await p.A.post(u.A.uploadDocuments,o,{onUploadProgress:e=>{const s=e.loaded,t=Math.round(100*s/e.total);Q(t),console.log((0,g.KU)(s)),ee((0,g.KU)(s))}});var t,a;if(i)return s[0].isUpload=!0,s[0].file=null===i||void 0===i||null===(t=i.data)||void 0===t?void 0:t.nations,console.log(i,"asddasasd"),null===i||void 0===i||null===(a=i.data)||void 0===a?void 0:a.path}catch(o){(0,d.LY)(o)}};return(0,E.jsx)("div",{children:(0,E.jsxs)(o.A,{sx:{p:3},component:"form",onSubmit:F((async e=>{U(!1),Se(!0),console.log(e);let s=Ce.find((e=>"passport"==e.key));console.log(s,"asdasad");new Date;const t=(e=>{let s=!1;for(let t=0;t<e.length;t++){const a=e[t];if(a.expiry_date&&"passport"!==a.key&&"otherdoc"!==a.key){const e=w()(a.expiry_date).startOf("day"),t=w()().startOf("day");if(console.log(e.format("YYYY-MM-DD")),console.log(t.format("YYYY-MM-DD")),e.isBefore(t)){(0,h.Ni)(`${a.name} Date is not Valid.`),s=!0;break}}}return s})(Ce);if(w()(null===s||void 0===s?void 0:s.expiry_date).startOf("day")<w()().add(6,"months").startOf("day")&&!t)(0,h.Ni)("Passport Expiry Date Must Be greater than "+w()().add(6,"months").startOf("day").format("MM-DD-YYYY"));else if(t);else try{let s={name:null===e||void 0===e?void 0:e.agentName,email:null===e||void 0===e?void 0:e.email,commission_visa:null===e||void 0===e?void 0:e.commissionVisa,commission_monthly:null===e||void 0===e?void 0:e.commissionMonthly,documents:Ce};console.log(s);const t=y.A.CreateAgent(s);(0,h.y8)(t,"Saving ...","Success","Something Went Wrong");const a=await t;200===(null===a||void 0===a?void 0:a.responseCode)&&H("/commission-list")}catch(a){}finally{Se(!1)}})),children:[(0,E.jsxs)(o.A,{sx:{display:"flex",justifyContent:"space-between",gap:"10px",alignItems:"flex-end"},children:[(0,E.jsx)(i.A,{sx:{fontSize:"22px",fontWeight:"bold"},children:"ADD NEW"}),(0,E.jsx)(o.A,{sx:{display:"flex",gap:"10px"},children:(0,E.jsx)(x.jn,{bgcolor:"#bd9b4a",title:"Save",disabled:!we,type:"submit"})})]}),(0,E.jsxs)(l.Ay,{container:!0,sx:{gap:"5px 25px"},children:[(0,E.jsx)(l.Ay,{item:!0,xs:5,children:(0,E.jsx)(v.A,{label:"Agent Name :*",size:"small",placeholder:"Agent Name",error:null===Z||void 0===Z||null===(e=Z.agentName)||void 0===e?void 0:e.message,register:$("agentName",{required:"Please enter your agent name."})})}),(0,E.jsx)(l.Ay,{item:!0,xs:5,children:(0,E.jsx)(v.A,{label:"Email :*",size:"small",placeholder:"Email",error:null===Z||void 0===Z||null===(s=Z.email)||void 0===s?void 0:s.message,register:$("email",{required:"Please enter your email.",onChange:e=>{console.log("asdas"),(0,g.O0)((()=>(async()=>{let e=T("email");if(e)try{let s={email:e.toLowerCase(),validate:!0};console.log(s);const{status:t}=await b.A.addCustomer(s);console.log(t),t&&Ee(!0)}catch(s){console.log(s),Ee(!1),(0,h.Ni)(s)}})()))},pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Please enter a valid email address."}})})}),(0,E.jsxs)(l.Ay,{container:!0,sx:{gap:"5px 25px"},children:[(0,E.jsx)(l.Ay,{item:!0,xs:5,children:(0,E.jsx)(f.A,{label:"Commission on Visa :* ",max:100,step:"0.01",StartLabel:"%",placeholder:"Enter Percentage",error:null===Z||void 0===Z||null===(t=Z.commissionVisa)||void 0===t?void 0:t.message,register:$("commissionVisa",{required:"Enter commission on Visa"})})}),(0,E.jsx)(l.Ay,{item:!0,xs:5,children:(0,E.jsx)(f.A,{label:"Commission on Monthly Revenue :* ",max:100,step:"0.01",StartLabel:"%",placeholder:"Enter Percentage",error:null===Z||void 0===Z||null===(S=Z.commissionMonthly)||void 0===S?void 0:S.message,register:$("commissionMonthly",{required:"Enter Monthly Commission"})})})]})]}),(0,E.jsx)(i.A,{sx:{fontSize:"18px",fontWeight:"bold",color:n.A.textColorDarkBlue,mb:2,mt:2},children:"Upload Documents: "}),(0,E.jsxs)(l.Ay,{container:!0,sx:{gap:"5px 25px"},children:[(0,E.jsxs)(l.Ay,{item:!0,xs:5,children:[(0,E.jsx)(i.A,{sx:{fontSize:"18px",fontWeight:"bold",color:n.A.gray},children:"Trade License:* "}),(0,E.jsx)(a.A,{Memo:!0,accept:R,file:Ce,multiple:!0,updateResult:Ie,fileId:"tradeLicense",error:null===Z||void 0===Z||null===(I=Z.tradeLicense)||void 0===I?void 0:I.message,loader:ae,disabled:xe,register:$("tradeLicense",{required:""==(null===(k=Ce.find((e=>"tradeLicense"==(null===e||void 0===e?void 0:e.key))))||void 0===k?void 0:k.path)&&"Please upload your trade license.",onChange:async e=>{ye(!0);const s=await Me(e,"tradeLicense");s&&(ke("path",s,"tradeLicense"),console.log(s)),ye(!1)}})})]}),(0,E.jsxs)(l.Ay,{item:!0,xs:5,children:[(0,E.jsx)(i.A,{sx:{fontSize:"18px",fontWeight:"bold",color:n.A.gray},children:"Passport :* "}),(0,E.jsx)(a.A,{Memo:!0,accept:R,file:Ce,multiple:!0,updateResult:Ie,fileId:"passport",error:null===Z||void 0===Z||null===(C=Z.passport)||void 0===C?void 0:C.message,loader:ae,disabled:xe,register:$("passport",{required:""==(null===(L=Ce.find((e=>"passport"==(null===e||void 0===e?void 0:e.key))))||void 0===L?void 0:L.path)&&"Please upload your passport.",onChange:async e=>{ye(!0);const s=await Me(e,"passport");s&&(ke("path",s,"passport"),console.log(s)),ye(!1)}})})]}),(0,E.jsx)(l.Ay,{item:!0,xs:5,children:(0,E.jsx)(r.A,{disablePast:!0,size:"small",label:"Trade License  Expiry Date :*",value:ue,error:null===Z||void 0===Z||null===(M=Z.LiscenseExp)||void 0===M?void 0:M.message,register:$("LiscenseExp",{required:"please enter your License expiry date."}),onChange:e=>{K("LiscenseExp",e),ge(new Date(e)),ke("date",new Date(e),"tradeLicense")}})}),(0,E.jsx)(l.Ay,{item:!0,xs:5,children:(0,E.jsx)(r.A,{disablePast:!0,size:"small",label:"Passport Expiry Date :*",value:je,minDate:(0,D.A)(new Date,6),error:null===Z||void 0===Z||null===(P=Z.passportExp)||void 0===P?void 0:P.message,register:$("passportExp",{required:"please enter your passport expiry date."}),onChange:e=>{K("passportExp",e),be(new Date(e)),ke("date",new Date(e),"passport")}})}),(0,E.jsxs)(l.Ay,{item:!0,xs:5,children:[(0,E.jsx)(i.A,{sx:{fontSize:"18px",fontWeight:"bold",color:n.A.gray},children:"Emirate ID's:* "}),(0,E.jsx)(a.A,{Memo:!0,accept:R,file:Ce,multiple:!0,updateResult:Ie,fileId:"emirateIds",error:null===Z||void 0===Z||null===(_=Z.emirateIds)||void 0===_?void 0:_.message,loader:ae,disabled:xe,register:$("emirateIds",{required:""==(null===(q=Ce.find((e=>"emirateIds"==(null===e||void 0===e?void 0:e.key))))||void 0===q?void 0:q.path)&&"Please upload your trade emirateIds.",onChange:async e=>{ye(!0);const s=await Me(e,"emirateIds");s&&(ke("path",s,"emirateIds"),console.log(s)),ye(!1)}})})]}),(0,E.jsxs)(l.Ay,{item:!0,xs:5,children:[(0,E.jsx)(i.A,{sx:{fontSize:"18px",fontWeight:"bold",color:n.A.gray},children:"Agreement :* "}),(0,E.jsx)(a.A,{Memo:!0,accept:R,error:null===Z||void 0===Z||null===(z=Z.Agreement)||void 0===z?void 0:z.message,file:Ce,multiple:!0,updateResult:Ie,fileId:"Agreement",loader:ae,disabled:xe,register:$("Agreement",{required:""==(null===(Y=Ce.find((e=>"Agreement"==(null===e||void 0===e?void 0:e.key))))||void 0===Y?void 0:Y.path)&&"Please upload your trade Agreement.",onChange:async e=>{ye(!0);const s=await Me(e,"Agreement");s&&(ke("path",s,"Agreement"),console.log(s)),ye(!1)}})})]}),(0,E.jsx)(l.Ay,{item:!0,xs:5,children:(0,E.jsx)(r.A,{disablePast:!0,size:"small",label:"Emirate ID's  Expiry Date :*",value:he,error:null===Z||void 0===Z||null===(N=Z.emirateIDsExpiry)||void 0===N?void 0:N.message,register:$("emirateIDsExpiry",{required:"please enter your passport expiry date."}),onChange:e=>{K("emirateIDsExpiry",e),ve(new Date(e)),ke("date",new Date(e),"emirateIds")}})}),(0,E.jsx)(l.Ay,{item:!0,xs:5,children:(0,E.jsx)(r.A,{disablePast:!0,size:"small",label:"Agreement Expiry Date :*",value:fe,error:null===Z||void 0===Z||null===(W=Z.agreementExpiry)||void 0===W?void 0:W.message,register:$("agreementExpiry",{required:"please enter your agreement expiry date."}),onChange:e=>{K("agreementExpiry",e),Ae(new Date(e)),ke("date",new Date(e),"Agreement")}})}),(0,E.jsxs)(l.Ay,{item:!0,xs:5,children:[(0,E.jsx)(i.A,{sx:{fontSize:"18px",fontWeight:"bold",color:n.A.gray},children:"Other Documents : "}),(0,E.jsx)(a.A,{Memo:!0,accept:R,file:Ce,multiple:!0,updateResult:Ie,fileId:"otherdoc",error:null===Z||void 0===Z||null===(O=Z.otherdoc)||void 0===O?void 0:O.message,loader:ae,disabled:xe,register:$("otherdoc",{required:!1,onChange:async e=>{ye(!0);const s=await Me(e,"otherdoc");s&&(ke("path",s,"otherdoc"),console.log(s)),ye(!1)}})})]})]})]})})}}}]);
//# sourceMappingURL=3561.42ef7fc0.chunk.js.map