"use strict";(self.webpackChunkgalaxy_web=self.webpackChunkgalaxy_web||[]).push([[5082],{51387:(e,t,i)=>{i.d(t,{A:()=>n});var l=i(66734),o=i(70579);const n=(0,l.A)((0,o.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete")},75082:(e,t,i)=>{i.r(t),i.d(t,{default:()=>V});var l=i(65043),o=i(28076),n=i(39652),r=i(77502),s=i(96446),a=i(85865),d=i(68903),c=i(79650),u=i(63336),x=i(71806),h=i(84882),v=i(73460),g=i(17392),p=i(45903),A=i(24858),m=i(73216),y=i(37230),j=i(91284),b=i(77020),S=i(54620),C=(i(44563),i(20566)),f=i(2010),w=i(51387),E=i(79456),N=i(93445),_=i(22030),D=i(95692),z=i(14398),F=i(70579);const J=(0,p.A)(o.A)((e=>{let{theme:t}=e;return{border:0}})),B=(0,p.A)(n.A)((e=>{let{theme:t}=e;return{[`&.${r.A.head}`]:{fontSize:14,fontFamily:"Public Sans",border:"1px solid #EEEEEE",padding:"15px",textAlign:"left",whiteSpace:"nowrap",color:"#434343",paddingRight:"50px",background:"transparent",fontWeight:"bold"},[`&.${r.A.body}`]:{fontSize:14,fontFamily:"Public Sans",textWrap:"nowrap",padding:"5px !important",paddingLeft:"15px !important",".MuiBox-root":{display:"flex",gap:"6px",alignItems:"center",justifyContent:"center",".MuiBox-root":{cursor:"pointer"}},svg:{width:"auto",height:"24px"},".MuiTypography-root":{textTransform:"capitalize",fontFamily:S.ay.NunitoRegular,textWrap:"nowrap"},".MuiButtonBase-root":{padding:"8px",width:"28px",height:"28px"}}}}));const V=function(){var e,t,i,n;const[r]=(0,z.Z)(!1),p=(0,m.Zp)(),{usdExchangeRate:V,cadExchangeRate:W}=(0,E.d4)((e=>e.navigationReducer)),{register:k,handleSubmit:M,formState:{errors:R},setValue:P,reset:q,getValues:H}=(0,A.mN)(),[T,I]=(0,l.useState)(!1),[O,Z]=(0,l.useState)([]),[$,G]=(0,l.useState)(null),[L,K]=(0,l.useState)([]),[Q,U]=(0,l.useState)(null),[X,Y]=(0,l.useState)([]),[ee,te]=(0,l.useState)(null),[ie,le]=(0,l.useState)([]),[oe,ne]=(0,l.useState)(null),[re,se]=(0,l.useState)([]),[ae,de]=(0,l.useState)(),[ce,ue]=(0,l.useState)(),[xe,he]=(0,l.useState)(),[ve,ge]=(0,l.useState)();let pe=0,Ae=0;const me=async e=>{try{let t={category_id:null!==e&&void 0!==e?e:""};const{data:i}=await f.A.getSubCategories(t);K(e?null===i||void 0===i?void 0:i.categories:[])}catch(t){(0,D.Ni)(t)}},ye=async(e,t)=>{try{var i;let l={page:1,limit:50,name:e,primary_account_id:null!==t&&void 0!==t?t:null===ee||void 0===ee?void 0:ee.id};const{data:o}=await f.A.getAccounts(l);le(null===o||void 0===o||null===(i=o.accounts)||void 0===i?void 0:i.rows)}catch(l){(0,D.Ni)(l)}};return(0,l.useEffect)((()=>{(async()=>{try{const{data:e}=await f.A.getMajorCategories();Z(null===e||void 0===e?void 0:e.categories)}catch(e){(0,D.Ni)(e)}})(),me(),ue(new Date),(async()=>{try{var e,t;let i={page:1,limit:1};const{data:l}=await f.A.getJournalVouchers(i);console.log(l),de(l),P("Journal",(null===l||void 0===l||null===(e=l.vouchers)||void 0===e?void 0:e.rows.length)>0?"JV-"+(parseFloat(null===l||void 0===l||null===(t=l.vouchers)||void 0===t?void 0:t.rows[0].id)+1):"JV-1")}catch(i){(0,D.Ni)(i)}})()}),[]),(0,F.jsxs)(s.A,{sx:{p:3,borderRadius:3},children:[(0,F.jsx)(a.A,{variant:"h5",sx:{color:b.A.charcoalGrey,fontFamily:S.ay.NunitoRegular,mb:4},children:"Create Journal Voucher"}),(0,F.jsxs)(s.A,{component:"form",onSubmit:M((async e=>{try{var t,i;const l=[...re];let o={account_id:ie.length>0?null===oe||void 0===oe?void 0:oe.id:null===ee||void 0===ee?void 0:ee.id,coa_code:null===e||void 0===e?void 0:e.accountCode,coa_name:ie.length>0?null===e||void 0===e?void 0:e.account:null===e||void 0===e?void 0:e.parentAccount,debit:null!==e&&void 0!==e&&e.debit?null===e||void 0===e?void 0:e.debit:0,credit:null!==e&&void 0!==e&&e.credit?null===e||void 0===e?void 0:e.credit:0,description:null===e||void 0===e?void 0:e.description,currency:null===oe||void 0===oe?void 0:oe.currency};l.push(o),se(l),q(),G(null),U(null),te(null),ne(null),le(),P("Journal",(null===ae||void 0===ae||null===(t=ae.vouchers)||void 0===t?void 0:t.rows.length)>0?"JV-"+(parseFloat(null===ae||void 0===ae||null===(i=ae.vouchers)||void 0===i?void 0:i.rows[0].id)+1):"JV-1")}catch(l){(0,D.Ni)(l)}})),children:[(0,F.jsxs)(d.Ay,{container:!0,spacing:2,children:[(0,F.jsx)(d.Ay,{item:!0,xs:12,sm:3,children:(0,F.jsx)(N.A,{disableFuture:!0,size:"small",label:"Journal Date",value:ce,onChange:e=>(e=>{try{if("Invalid Date"==e)return void ue("invalid");ue(new Date(e))}catch(t){(0,D.Ni)(t)}})(e)})}),(0,F.jsx)(d.Ay,{item:!0,xs:12,sm:3,children:(0,F.jsx)(C.A,{size:"small",disabled:!0,label:" Journal No.",placeholder:"Journal No.",register:k("Journal")})})]}),(0,F.jsxs)(d.Ay,{container:!0,spacing:2,children:[(0,F.jsx)(d.Ay,{item:!0,xs:12,sm:3,children:(0,F.jsx)(y.A,{size:"small",label:"Major Category",options:O,selected:$,error:null===R||void 0===R||null===(e=R.majorCategory)||void 0===e?void 0:e.message,onSelect:e=>{e||K([]),G(e),me(null===e||void 0===e?void 0:e.id),U(null)},register:k("majorCategory",{required:"Please select major category."})})}),(0,F.jsx)(d.Ay,{item:!0,xs:12,sm:3,children:(0,F.jsx)(y.A,{size:"small",label:"Sub Category",options:L,selected:Q,onSelect:e=>{U(e),(async e=>{try{var t;let i={sub_category:e};const{data:l}=await f.A.getAccountBySubCategory(i);Y(null===l||void 0===l||null===(t=l.accounts)||void 0===t?void 0:t.rows)}catch(i){(0,D.Ni)(i)}})(null===e||void 0===e?void 0:e.id)},error:null===R||void 0===R||null===(t=R.subCategory)||void 0===t?void 0:t.message,register:k("subCategory",{required:"Please select sub category."})})}),(0,F.jsx)(d.Ay,{item:!0,xs:12,sm:3,children:(0,F.jsx)(y.A,{disabled:!Q,size:"small",label:"Account",options:X,selected:ee,onSelect:e=>{te(e),ye("",null===e||void 0===e?void 0:e.id),P("accountCode",null===e||void 0===e?void 0:e.account_code)},error:null===R||void 0===R||null===(i=R.parentAccount)||void 0===i?void 0:i.message,register:k("parentAccount",{required:"Please select parent account."})})}),(0,F.jsx)(d.Ay,{item:!0,xs:12,sm:3,children:(null===ie||void 0===ie?void 0:ie.length)>0&&(0,F.jsx)(y.A,{disabled:!ee,size:"small",label:"Child Account",onSearch:e=>ye(e),options:ie,selected:oe,onSelect:e=>{ne(e),P("accountCode",null===e||void 0===e?void 0:e.account_code)},error:null===R||void 0===R||null===(n=R.description)||void 0===n?void 0:n.message,register:k("account",{required:(null===ie||void 0===ie?void 0:ie.length)>0&&"Please select a account"})})}),(0,F.jsx)(d.Ay,{item:!0,xs:12,sm:3,children:(0,F.jsx)(C.A,{disabled:!0,size:"small",label:"Account Code",placeholder:"Account Code",register:k("accountCode")})}),(0,F.jsx)(d.Ay,{item:!0,xs:12,sm:3,children:(0,F.jsx)(C.A,{size:"small",label:"Debit  (AED)",placeholder:"Debit",register:k("debit",{onChange:e=>{P("credit",0),H("debit")<0&&P("debit",0)}})})}),(0,F.jsx)(d.Ay,{item:!0,xs:12,sm:3,children:(0,F.jsx)(C.A,{size:"small",label:"Credit  (AED)",placeholder:"Credit",register:k("credit",{onChange:e=>{P("debit",0),H("credit")<0&&P("credit",0)}})})}),(0,F.jsx)(d.Ay,{item:!0,xs:12,sm:3,children:(0,F.jsx)(C.A,{size:"small",label:"Description",placeholder:"Description",register:k("description")})}),(0,F.jsx)(d.Ay,{item:!0,xs:12,sm:12,sx:{mt:2,textAlign:"right"},children:(0,F.jsx)(j.jn,{title:"Add",type:"submit"})})]})]}),re.length>0&&(0,F.jsxs)(l.Fragment,{children:[(0,F.jsx)(c.A,{component:u.A,sx:{mt:2,boxShadow:"0px 8px 18px 0px #9B9B9B1A",borderRadius:2,maxHeight:"calc(100vh - 330px)"},children:(0,F.jsxs)(x.A,{stickyHeader:!0,sx:{minWidth:500},children:[(0,F.jsx)(h.A,{children:(0,F.jsx)(o.A,{children:["Sr.No","COA Code","COA Name","Debit (AED)","Credit (AED)","Description","Action"].map(((e,t)=>(0,F.jsx)(B,{children:e},t)))})}),(0,F.jsxs)(v.A,{children:[re.map(((e,t)=>{var i,l,o,n,r;return pe+=parseFloat(e.debit),Ae+=parseFloat(e.credit),(0,F.jsxs)(J,{sx:{bgcolor:t%2!==0&&"#EEFBEE"},children:[(0,F.jsx)(B,{children:t+1}),(0,F.jsx)(B,{children:null!==(i=null===e||void 0===e?void 0:e.coa_code)&&void 0!==i?i:"-"}),(0,F.jsx)(B,{children:null!==(l=null===e||void 0===e?void 0:e.coa_name)&&void 0!==l?l:"-"}),(0,F.jsx)(B,{children:null!==(o=null===e||void 0===e?void 0:e.debit)&&void 0!==o?o:"-"}),(0,F.jsx)(B,{children:null!==(n=null===e||void 0===e?void 0:e.credit)&&void 0!==n?n:"-"}),(0,F.jsx)(B,{children:null!==(r=null===e||void 0===e?void 0:e.description)&&void 0!==r?r:"-"}),(0,F.jsx)(B,{children:(0,F.jsx)(s.A,{sx:{gap:"16px !important"},children:(0,F.jsxs)(s.A,{onClick:()=>(async e=>{I(!0);try{const t=[...re];t.splice(e,1),se(t)}catch(t){(0,D.Ni)(t)}finally{I(!1)}})(t),children:[(0,F.jsx)(g.A,{sx:{bgcolor:b.A.danger,"&:hover":{bgcolor:b.A.danger}},children:(0,F.jsx)(w.A,{sx:{color:b.A.white,height:"16px !important"}})}),(0,F.jsx)(a.A,{variant:"body2",children:"Delete"})]})})})]},t)})),(0,F.jsxs)(J,{sx:{bgcolor:"#EEFBEE"},children:[(0,F.jsx)(B,{colSpan:3,children:(0,F.jsx)(a.A,{variant:"body1",sx:{fontWeight:700},children:"Total"})}),(0,F.jsx)(B,{children:(0,F.jsx)(a.A,{variant:"body1",sx:{fontWeight:700},children:parseFloat(pe).toFixed(2)})}),(0,F.jsx)(B,{children:(0,F.jsx)(a.A,{variant:"body1",sx:{fontWeight:700},children:parseFloat(Ae).toFixed(2)})}),(0,F.jsx)(B,{}),(0,F.jsx)(B,{})]})]})]})}),(0,F.jsxs)(d.Ay,{container:!0,spacing:2,children:[(0,F.jsx)(d.Ay,{item:!0,xs:12,sm:12,children:Ae!==pe&&(0,F.jsx)(a.A,{color:"error",sx:{fontSize:12,textAlign:"left"},children:"Debit and Credit are not equal."})}),(0,F.jsx)(d.Ay,{item:!0,xs:12,sm:4,children:(0,F.jsx)(C.A,{label:"Note",placeholder:"Note",register:k("note")})})]}),(0,F.jsx)(s.A,{sx:{mt:2,textAlign:"right"},children:(0,F.jsx)(j.jn,{disabled:Ae!==pe,title:"Submit",loading:T,onClick:()=>(async()=>{I(!0);try{const e=re.map((e=>{const t="aed"===e.currency?"":"usd"===e.currency?e.debit*V:e.debit*W,i="aed"===e.currency?"":"usd"===e.currency?e.credit*V:e.credit*W;return{account_id:e.account_id,debit:e.debit,debit_cur:t||0,credit:e.credit,credit_cur:i||0,currency:e.currency,description:e.description}}));let t={total:pe,notes:H("note"),entries:e,created_at:(0,_.Wr)(ce)};const i=f.A.createJournalVoucher(t);(0,D.y8)(i,"Saving...","Added Successfully","Something Went Wrong");const l=await i;200===(null===l||void 0===l?void 0:l.responseCode)&&p("/journal-voucher-list")}catch(e){(0,D.Ni)(e)}finally{I(!1)}})()})})]})]})}}}]);
//# sourceMappingURL=5082.f0a59fea.chunk.js.map