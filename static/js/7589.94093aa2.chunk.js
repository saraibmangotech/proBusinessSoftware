"use strict";(self.webpackChunkgalaxy_web=self.webpackChunkgalaxy_web||[]).push([[7589],{57589:(e,l,i)=>{i.r(l),i.d(l,{default:()=>T});var t=i(65043),n=i(96446),s=i(85865),o=i(68903),a=i(17392),d=i(79650),r=i(63336),c=i(71806),u=i(84882),v=i(28076),m=i(39652),x=i(73460),p=i(1403),h=(i(8781),i(26240)),A=i(42518),g=i(91284),j=(i(77020),i(24858)),b=(i(18285),i(20566)),S=i(93445),y=i(44563),_=(i(99543),i(37230)),f=(i(22030),i(88073),i(50857),i(85900)),w=(i(2722),i(95692)),k=i(86178),C=i.n(k),z=i(73216),I=(i(70255),i(28153),i(54620),i(14398),i(19668)),D=i(2010),E=i(66360),R=i(70579);const T=function(){var e,l,i,k,T,L,N,W,Y;(0,h.A)();const{user:F}=(0,I.A)(),[B,P]=((0,z.Zp)(),(0,t.useState)(!1)),[U,V]=(0,t.useState)(!1),[H,M]=(0,t.useState)("no"),[q,G]=(0,t.useState)("no"),[O,Q]=(0,t.useState)(0),[Z,$]=(0,t.useState)(0),[J,K]=(0,t.useState)(!1),[X,ee]=(0,t.useState)([]);console.log(X,"data");const[le,ie]=(0,t.useState)([{itemCode:"",itemDescription:"TASHEEL AUTO 19",totalCharge:17.1,mbNo:"",applicationId:"",total:17.1}]),{register:te,handleSubmit:ne,getValues:se,setValue:oe,watch:ae,reset:de,formState:{errors:re}}=(0,j.mN)(),{register:ce,handleSubmit:ue,setValue:ve,getValues:me,control:xe,watch:pe,formState:{errors:he}}=(0,j.mN)(),Ae=ae("govt_fee",0),ge=ae("center_fee",0),je=ae("bank_charges",0),be=ae("qty",1);(0,t.useEffect)((()=>{const e=((parseFloat(Ae)||0)+(parseFloat(ge)||0)+(parseFloat(je)||0))*(parseFloat(be)||1);oe("total",e)}),[Ae,ge,je,be]);const[Se,ye]=(0,t.useState)([]),[_e,fe]=t.useState(1),[we,ke]=(0,t.useState)(0),[Ce,ze]=(0,t.useState)(0),[Ie,De]=(0,t.useState)([]),[Ee,Re]=(0,t.useState)({id:"Instant",name:"Instant"}),[Te,Le]=(0,t.useState)(),[Ne,We]=(0,t.useState)(!1),[Ye,Fe]=(0,t.useState)(!1),[Be,Pe]=(0,t.useState)(!1),[Ue,Ve]=(0,t.useState)(!1),[He,Me]=(0,t.useState)(!1),[qe,Ge]=(0,t.useState)(!1),[Oe,Qe]=(0,t.useState)(null),[Ze,$e]=(0,t.useState)(null),[Je,Ke]=(0,t.useState)(!1),[Xe,el]=(0,t.useState)(),[ll,il]=(0,t.useState)(),[tl,nl]=(0,t.useState)(null),[sl,ol]=(0,t.useState)(null),[al,dl]=(0,t.useState)(null),[rl,cl]=(0,t.useState)(null),[ul,vl]=((0,t.useRef)(null),(0,t.useState)(!1)),[ml,xl]=(0,t.useState)([]),[pl,hl]=(0,t.useState)(null),[Al,gl]=(0,t.useState)(null),[jl,bl]=(0,t.useState)(null),[Sl,yl]=(0,t.useState)(null),[_l,fl]=(0,t.useState)(null),[wl,kl]=(0,t.useState)(null),[Cl,zl]=(0,t.useState)(null),[Il,Dl]=(0,t.useState)([]),[El,Rl]=(0,t.useState)(null),[Tl,Ll]=(0,t.useState)(null),[Nl,Wl]=(0,t.useState)(null),[Yl,Fl]=(0,t.useState)(null),[Bl,Pl]=(0,t.useState)(null),[Ul,Vl]=(0,t.useState)(null),[Hl,Ml]=(0,t.useState)(null),[ql,Gl]=(0,t.useState)(null),[Ol,Ql]=(0,t.useState)(null),[Zl,$l]=(0,t.useState)(null),[Jl,Kl]=(0,t.useState)([]),[Xl,ei]=(0,t.useState)(null),{id:li}=(0,z.g)();console.log("object",null===(e=me("bank"))||void 0===e?void 0:e.id);const ii=async e=>{Ke(!0);try{let h={token_number:me("token")};e&&(h={invoice_number:me("invoicenumber")});const{data:A}=await f.A.getReceiptDetail(h);var l,i,t,n,s,o,a,d,r,c,u,v,m,x,p;if(console.log(null===A||void 0===A?void 0:A.receipt,"dataaa"),null!==A&&void 0!==A&&A.receipt)ee(null===A||void 0===A||null===(l=A.receipt)||void 0===l?void 0:l.sale_receipt_items),$l(null===A||void 0===A?void 0:A.receipt),ve("paid",0),ve("customer",null===A||void 0===A||null===(i=A.receipt)||void 0===i?void 0:i.customer_name),ve("invoice_date",C()().toDate()),ol(new Date(null===A||void 0===A||null===(t=A.receipt)||void 0===t?void 0:t.invoice_date)),ve("mobile",null===A||void 0===A||null===(n=A.receipt)||void 0===n?void 0:n.customer_mobile),ve("ref",null===A||void 0===A||null===(s=A.receipt)||void 0===s?void 0:s.ref),ve("display_customer",null===A||void 0===A||null===(o=A.receipt)||void 0===o?void 0:o.customer_name),ve("email",null===A||void 0===A||null===(a=A.receipt)||void 0===a?void 0:a.customer_email),ve("address",null===A||void 0===A||null===(d=A.receipt)||void 0===d?void 0:d.address),ve("trn",null===A||void 0===A||null===(r=A.receipt)||void 0===r?void 0:r.trn),ve("cost_center",null===A||void 0===A||null===(c=A.receipt)||void 0===c?void 0:c.cost_center),ve("caseno",null===A||void 0===A||null===(u=A.receipt)||void 0===u?void 0:u.case_no),$(null===A||void 0===A||null===(v=A.receipt)||void 0===v?void 0:v.total_amount),ve("total",null===A||void 0===A||null===(m=A.receipt)||void 0===m?void 0:m.total_amount),ve("balance",null===A||void 0===A||null===(x=A.receipt)||void 0===x?void 0:x.total_amount),xl(null===A||void 0===A||null===(p=A.accounts)||void 0===p?void 0:p.rows)}catch(h){(0,y.LY)(h)}},ti=(e,l,i)=>{const t=[...X];t[e]={...t[e],[l]:i},ee(t)};return console.log(X),(0,t.useEffect)((()=>{(async()=>{try{var e,l,i,t,n,s,o,a,d,r,c,u;let v={id:li};const{data:m}=await f.A.getPreSaleDetail(v);console.log(null===m||void 0===m||null===(e=m.receipt)||void 0===e?void 0:e.sale_receipt_items),ve("token",null===m||void 0===m||null===(l=m.receipt)||void 0===l?void 0:l.token_number),ve("mobileValue",null===m||void 0===m||null===(i=m.receipt)||void 0===i?void 0:i.customer_mobile),ee(null===m||void 0===m||null===(t=m.receipt)||void 0===t?void 0:t.sale_receipt_items),$(null===m||void 0===m||null===(n=m.receipt)||void 0===n?void 0:n.total_amount),ol(new Date(null===m||void 0===m||null===(s=m.receipt)||void 0===s?void 0:s.invoice_date)),ve("invoicenumber",null===m||void 0===m||null===(o=m.receipt)||void 0===o?void 0:o.id),ii(!0),ve("display_customer",null===m||void 0===m||null===(a=m.receipt)||void 0===a?void 0:a.customer_name),ve("mobile",null===m||void 0===m||null===(d=m.receipt)||void 0===d?void 0:d.customer_mobile),ve("email",null===m||void 0===m||null===(r=m.receipt)||void 0===r?void 0:r.customer_email),ve("ref",null===m||void 0===m||null===(c=m.receipt)||void 0===c?void 0:c.ref),ve("address",null===m||void 0===m||null===(u=m.receipt)||void 0===u?void 0:u.address)}catch(v){console.error("Error fetching location:",v)}})(),(async()=>{Ge(!0);try{let e={page:1,limit:1e3};const{data:l}=await f.A.getBanks(e);Kl(null===l||void 0===l?void 0:l.banks)}catch(e){(0,w.Ni)(e)}finally{Ge(!1)}})(),(async()=>{try{var e,l;let i={page:1,limit:1e3};const{data:t}=await D.A.getAccounts(i);console.log(null===t||void 0===t||null===(e=t.accounts)||void 0===e?void 0:e.rows),xl(null===t||void 0===t||null===(l=t.accounts)||void 0===l?void 0:l.rows)}catch(i){(0,y.LY)(i)}})(),(async()=>{try{var e;let l={page:1,limit:1e3};const{data:i}=await D.A.getTax(l);console.log(null===i||void 0===i||null===(e=i.accounts)||void 0===e?void 0:e.rows),Dl(null===i||void 0===i?void 0:i.tax)}catch(l){(0,y.LY)(l)}})(),(async()=>{try{let e={page:1,limit:1e3};const{data:l}=await f.A.getCategoryList(e);Wl(null===l||void 0===l?void 0:l.categories)}catch(e){(0,y.LY)(e)}})(),(async()=>{try{let e={page:1,limit:1e3};const{data:l}=await f.A.getServiceItem(e);Ml(null===l||void 0===l?void 0:l.rows)}catch(e){(0,y.LY)(e)}})(),Ql({id:"walkin",name:"Walk-in Customer"}),ve("customer",{id:"walkin",name:"Walk-in Customer"})}),[]),(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(n.A,{sx:{width:"100%"}}),(0,R.jsx)(n.A,{m:3,sx:{backgroundColor:"white",borderRadius:"12px"},children:(0,R.jsx)(R.Fragment,{children:(0,R.jsxs)(n.A,{component:"form",onSubmit:ue((async e=>{try{var l;let i={id:me("invoicenumber"),total_amount:null===e||void 0===e?void 0:e.total,paid_amount:null===e||void 0===e?void 0:e.total,payment_status:"Paid",payment_mode:null===Xl||void 0===Xl?void 0:Xl.id,account_id:"Cash"==(null===Xl||void 0===Xl?void 0:Xl.id)?700117:"Bank"==(null===Xl||void 0===Xl?void 0:Xl.id)?null===(l=me("bank"))||void 0===l?void 0:l.id:null,ref_id:"Bank"==(null===Xl||void 0===Xl?void 0:Xl.id)||"Bank"==(null===Xl||void 0===Xl?void 0:Xl.id)?"2":null,remarks:null===e||void 0===e?void 0:e.remarks,narration:null===e||void 0===e?void 0:e.narration};if(1==(null===Zl||void 0===Zl?void 0:Zl.is_paid))(0,y.LY)("Already paid");else{const e=f.A.UpdateReceipt(i);(0,w.y8)(e,"Saving...","Added Successfully","Something Went Wrong");const l=await e;200===(null===l||void 0===l?void 0:l.responseCode)&&window.location.reload()}}catch(i){(0,y.LY)(i)}})),children:[(0,R.jsx)(n.A,{sx:{display:"flex",justifyContent:"space-between",gap:"10px",p:3,alignItems:"flex-end"},children:(0,R.jsx)(s.A,{sx:{fontSize:"22px",fontWeight:"bold"},children:"Update Pay Receipt"})}),(0,R.jsx)(n.A,{sx:{p:3},children:(0,R.jsxs)(o.Ay,{container:!0,sx:{gap:"5px 25px"},children:[(0,R.jsx)(o.Ay,{item:!0,xs:12,children:(0,R.jsxs)(o.Ay,{container:!0,gap:2,alignItems:"center",children:[(0,R.jsx)(o.Ay,{item:!0,xs:3,children:(0,R.jsx)(S.A,{label:"Invoice Date :*",value:sl,size:"small",disabled:!0,error:null===he||void 0===he||null===(l=he.date)||void 0===l?void 0:l.message,register:ce("date"),onChange:e=>{ve("date",e),ol(new Date(e))}})}),(0,R.jsx)(o.Ay,{item:!0,md:3,sm:12,xs:12,mt:1,children:(0,R.jsx)(b.A,{label:"Invoice Number",size:"small",disabled:Je,placeholder:"Invoice Number",register:ce("invoicenumber"),InputProps:{endAdornment:(0,R.jsx)(a.A,{onClick:()=>ii(!0),children:(0,R.jsx)(E.A,{sx:{color:"#bd9b4a"}})})}})}),(0,R.jsx)(o.Ay,{item:!0,md:3,sm:12,xs:12,mt:2.5,children:(0,R.jsx)(g.jn,{bgcolor:"#bd9b4a",title:"Clear",onClick:()=>{Ke(!1),ve("token",""),ve("invoicenumber",""),ve("customer",""),ve("invoice_date",""),ve("mobile",""),ve("ref",""),ve("display_customer",""),ve("email",""),ve("address",""),ve("trn",""),ve("cost_center","")},loading:Be})})]})}),(0,R.jsx)(o.Ay,{item:!0,md:12,sm:12,xs:12,sx:{border:"2px solid black",p:2,borderRadius:"15px",mt:{md:0,sm:2,xs:2}},children:(0,R.jsxs)(o.Ay,{container:!0,sx:{gap:"5px 25px"},children:[(0,R.jsx)(o.Ay,{item:!0,md:3.8,sm:5.5,xs:12,children:(0,R.jsx)(_.A,{size:"small",label:"Customer *:",disabled:!0,options:[{id:"walkin",name:"Walk-in Customer"}],selected:Ol,onSelect:e=>{Ql(e)},error:null===he||void 0===he||null===(i=he.customer)||void 0===i?void 0:i.message,register:ce("customer")})}),(0,R.jsx)(o.Ay,{item:!0,md:3.8,sm:5.5,xs:12,children:(0,R.jsx)(b.A,{label:"Display Customer",size:"small",disabled:!0,placeholder:"Walk-in Customer",register:ce("display_customer"),error:null===he||void 0===he||null===(k=he.display_customer)||void 0===k?void 0:k.message})}),(0,R.jsx)(o.Ay,{item:!0,md:3.8,sm:5.5,xs:12,children:(0,R.jsx)(b.A,{label:"Mobile",size:"small",placeholder:"Mobile No",disabled:!0,register:ce("mobile",{pattern:{value:/^05[0-9]{8}$/,message:"Please enter a valid UAE phone number (starting with 05 and 8 digits)."}}),error:null===he||void 0===he||null===(T=he.display_customer)||void 0===T?void 0:T.message})}),(0,R.jsx)(o.Ay,{item:!0,md:3.8,sm:5.5,xs:12,children:(0,R.jsx)(b.A,{label:"Email",size:"small",placeholder:"Email",disabled:!0,register:ce("email"),error:null===he||void 0===he||null===(L=he.email)||void 0===L?void 0:L.message})}),(0,R.jsx)(o.Ay,{item:!0,md:3.8,sm:5.5,xs:12,children:(0,R.jsx)(b.A,{label:"TRN",size:"small",placeholder:"TRN",disabled:!0,register:ce("trn"),error:null===he||void 0===he||null===(N=he.trn)||void 0===N?void 0:N.message})}),(0,R.jsx)(o.Ay,{item:!0,md:3.8,sm:5.5,xs:12,children:(0,R.jsx)(b.A,{label:"Ref",disabled:!0,size:"small",placeholder:"Reference",register:ce("ref")})}),(0,R.jsx)(o.Ay,{item:!0,md:3.8,sm:5.5,xs:12,children:(0,R.jsx)(_.A,{label:"Cost Center",size:"small",disabled:!0,options:[{id:"Al-ADHEED",name:"Al-ADHEED"}],selected:pe("cost_center"),onSelect:e=>ve("cost_center",e),register:ce("cost_center"),error:null===he||void 0===he||null===(W=he.cost_center)||void 0===W?void 0:W.message})}),(0,R.jsx)(o.Ay,{item:!0,md:3.8,sm:5.5,xs:12,children:(0,R.jsx)(b.A,{label:"Address",size:"small",placeholder:"Address",multiline:!0,disabled:!0,rows:2,register:ce("address"),error:null===he||void 0===he||null===(Y=he.address)||void 0===Y?void 0:Y.message})})]})})]})}),(0,R.jsx)(d.A,{component:r.A,children:(0,R.jsxs)(c.A,{children:[(0,R.jsx)(u.A,{children:(0,R.jsxs)(v.A,{children:[(0,R.jsx)(m.A,{sx:{width:"150px"},children:"Item Code"}),(0,R.jsx)(m.A,{sx:{width:"400px"},children:"Service"}),(0,R.jsx)(m.A,{sx:{width:"150px"},children:"Qty"}),(0,R.jsx)(m.A,{sx:{width:"150px"},children:"Govt fee"}),(0,R.jsx)(m.A,{sx:{width:"150px"},children:"Center fee"}),(0,R.jsx)(m.A,{sx:{width:"150px"},children:"Bank Charge"}),(0,R.jsx)(m.A,{sx:{width:"150px"},children:"Total"}),(0,R.jsx)(m.A,{sx:{width:"150px"},children:"Trans Id"}),(0,R.jsx)(m.A,{sx:{width:"150px"},children:"App Id"}),(0,R.jsx)(m.A,{sx:{width:"150px"},children:"Ref Id"}),(0,R.jsx)(m.A,{sx:{width:"150px"},children:"Action"})]})}),(0,R.jsxs)(x.A,{children:[null===X||void 0===X?void 0:X.map(((e,l)=>{var i;return(0,R.jsxs)(v.A,{children:[(0,R.jsx)(m.A,{children:null===e||void 0===e?void 0:e.id}),(0,R.jsx)(m.A,{children:null===e||void 0===e||null===(i=e.service)||void 0===i?void 0:i.name}),(0,R.jsx)(m.A,{children:null===e||void 0===e?void 0:e.quantity}),(0,R.jsx)(m.A,{children:null===e||void 0===e?void 0:e.govt_fee}),(0,R.jsx)(m.A,{children:null===e||void 0===e?void 0:e.center_fee}),(0,R.jsx)(m.A,{children:null===e||void 0===e?void 0:e.bank_charge}),(0,R.jsx)(m.A,{children:null===e||void 0===e?void 0:e.total}),(0,R.jsx)(m.A,{children:(0,R.jsx)(p.A,{size:"small",placeholder:"Transaction Id",type:"number",value:e.transaction_id||"",onChange:e=>ti(l,"transaction_id",e.target.value)})}),(0,R.jsx)(m.A,{children:(0,R.jsx)(p.A,{size:"small",placeholder:"Application Id",type:"number",value:e.application_id||"",onChange:e=>ti(l,"application_id",e.target.value)})}),(0,R.jsx)(m.A,{children:(0,R.jsx)(p.A,{size:"small",placeholder:"Ref No",type:"number",value:e.ref_no||"",onChange:e=>ti(l,"ref_no",e.target.value)})})]},l)})),(0,R.jsxs)(v.A,{children:[(0,R.jsx)(m.A,{colSpan:10,align:"right",children:(0,R.jsx)(s.A,{variant:"h6",sx:{fontSize:"15px"},children:"Sub-total:"})}),(0,R.jsxs)(m.A,{children:[(0,R.jsx)(s.A,{variant:"h6",sx:{fontSize:"15px"},children:Z})," "]})]}),(0,R.jsxs)(v.A,{children:[(0,R.jsx)(m.A,{colSpan:10,align:"right",children:(0,R.jsx)(s.A,{variant:"h6",sx:{fontSize:"15px"},children:"Amount Total:"})}),(0,R.jsxs)(m.A,{children:[(0,R.jsx)(s.A,{variant:"h6",sx:{fontSize:"15px"},children:Z})," "]})]}),(0,R.jsx)(v.A,{children:(0,R.jsxs)(m.A,{colSpan:10,align:"center",children:[" ",(0,R.jsxs)(n.A,{sx:{display:"flex",gap:2,justifyContent:"center"},children:[(0,R.jsx)(A.A,{type:"submit",variant:"contained",sx:{width:"350px",textTransform:"capitalize",backgroundColor:"#bd9b4a",":hover":{backgroundColor:"rgb(189 155 74)"}},children:"Update"}),(0,R.jsx)(A.A,{onClick:()=>K(!1),variant:"contained",sx:{width:"350px",textTransform:"capitalize",backgroundColor:"#bd9b4a",":hover":{backgroundColor:"rgb(189 155 74)"}},children:"Cancel"})]})]})})]})]})})]})})})]})}},66360:(e,l,i)=>{var t=i(24994);l.A=void 0;var n=t(i(40039)),s=i(70579);l.A=(0,n.default)((0,s.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search")}}]);
//# sourceMappingURL=7589.94093aa2.chunk.js.map