"use strict";(self.webpackChunkgalaxy_web=self.webpackChunkgalaxy_web||[]).push([[1562],{31562:(e,l,t)=>{t.r(l),t.d(l,{default:()=>I});var i=t(65043),s=t(96446),n=t(85865),o=t(68903),a=t(17392),d=t(79650),r=t(63336),u=t(71806),c=t(84882),v=t(28076),m=t(39652),x=t(73460),h=(t(8781),t(26240)),p=t(42518),A=(t(91284),t(77020),t(24858)),S=(t(18285),t(20566)),j=t(93445),g=t(44563),b=(t(99543),t(37230)),y=(t(22030),t(88073),t(50857),t(85900)),f=(t(2722),t(95692)),_=t(86178),k=t.n(_),w=t(73216),C=(t(70255),t(28153),t(54620),t(14398),t(19668)),z=t(2010),D=t(66360),E=t(70579);const I=function(){var e,l,t,_,I,T,q,R;(0,h.A)();const{user:L}=(0,C.A)(),N=(0,w.Zp)(),[W,F]=(0,i.useState)(!1),[Y,V]=(0,i.useState)(!1),[H,M]=(0,i.useState)("no"),[U,P]=(0,i.useState)("no"),[B,G]=(0,i.useState)(0),[O,Q]=(0,i.useState)(0),[Z,J]=(0,i.useState)([]),[K,X]=(0,i.useState)(null),[$,ee]=(0,i.useState)(!1);console.log(Z,"data");const[le,te]=(0,i.useState)([{itemCode:"",itemDescription:"TASHEEL AUTO 19",totalCharge:17.1,mbNo:"",applicationId:"",total:17.1}]),{register:ie,handleSubmit:se,getValues:ne,setValue:oe,watch:ae,reset:de,formState:{errors:re}}=(0,A.mN)(),{register:ue,handleSubmit:ce,setValue:ve,getValues:me,control:xe,watch:he,formState:{errors:pe}}=(0,A.mN)(),Ae=ae("govt_fee",0),Se=ae("center_fee",0),je=ae("bank_charge",0),ge=ae("quantity",1);(0,i.useEffect)((()=>{const e=((parseFloat(Ae)||0)+(parseFloat(Se)||0)+(parseFloat(je)||0))*(parseFloat(ge)||1);oe("total",e)}),[Ae,Se,je,ge]);const[be,ye]=(0,i.useState)([]),[fe,_e]=i.useState(1),{id:ke}=(0,w.g)(),[we,Ce]=(0,i.useState)(0),[ze,De]=(0,i.useState)(0),[Ee,Ie]=(0,i.useState)([]),[Te,qe]=(0,i.useState)({id:"Instant",name:"Instant"}),[Re,Le]=(0,i.useState)(),[Ne,We]=(0,i.useState)(!1),[Fe,Ye]=(0,i.useState)(!1),[Ve,He]=(0,i.useState)(!1),[Me,Ue]=(0,i.useState)(!1),[Pe,Be]=(0,i.useState)(!1),[Ge,Oe]=(0,i.useState)(!1),[Qe,Ze]=(0,i.useState)({monthlyVisaServiceCharges:!1,vipMedical:!1,extraTyping:!0}),[Je,Ke]=(0,i.useState)(null),[Xe,$e]=(0,i.useState)(null),[el,ll]=(0,i.useState)(),[tl,il]=(0,i.useState)(),[sl,nl]=(0,i.useState)(null),[ol,al]=(0,i.useState)(null),[dl,rl]=(0,i.useState)(null),[ul,cl]=(0,i.useState)(null),[vl,ml]=((0,i.useRef)(null),(0,i.useState)(!1)),[xl,hl]=(0,i.useState)([]),[pl,Al]=(0,i.useState)(null),[Sl,jl]=(0,i.useState)(null),[gl,bl]=(0,i.useState)(null),[yl,fl]=(0,i.useState)(null),[_l,kl]=(0,i.useState)(null),[wl,Cl]=(0,i.useState)(null),[zl,Dl]=(0,i.useState)(null),[El,Il]=(0,i.useState)([]),[Tl,ql]=(0,i.useState)(null),[Rl,Ll]=(0,i.useState)(null),[Nl,Wl]=(0,i.useState)(null),[Fl,Yl]=(0,i.useState)(null),[Vl,Hl]=(0,i.useState)(null),[Ml,Ul]=(0,i.useState)(null),[Pl,Bl]=(0,i.useState)(null),[Gl,Ol]=(0,i.useState)(null),[Ql,Zl]=(0,i.useState)(null),[Jl,Kl]=(0,i.useState)(null),Xl=async e=>{try{var l,t,i,s,n,o,a,d,r;let u={token_number:me("token")};e&&(u={invoice_number:me("invoicenumber")});const{data:c}=await y.A.getReceiptDetail(u);console.log(c,"dataaa"),Kl(null===c||void 0===c?void 0:c.token),ve("customer",null===c||void 0===c||null===(l=c.token)||void 0===l?void 0:l.customer_name),ve("invoice_date",k()().toDate()),ve("mobile",null===c||void 0===c||null===(t=c.token)||void 0===t?void 0:t.mobile),ve("ref",null===c||void 0===c||null===(i=c.token)||void 0===i?void 0:i.reference),ve("display_customer",null===c||void 0===c||null===(s=c.token)||void 0===s?void 0:s.customer_name),ve("email",null===c||void 0===c||null===(n=c.token)||void 0===n?void 0:n.email),ve("address",null===c||void 0===c||null===(o=c.token)||void 0===o?void 0:o.address),ve("trn",null===c||void 0===c||null===(a=c.token)||void 0===a?void 0:a.trn),ve("cost_center",null===c||void 0===c||null===(d=c.token)||void 0===d?void 0:d.cost_center),hl(null===c||void 0===c||null===(r=c.accounts)||void 0===r?void 0:r.rows)}catch(u){(0,g.LY)(u)}};return(0,i.useEffect)((()=>{(async()=>{try{var e;let l={page:1,limit:1e3};const{data:t}=await z.A.getAccounts(l);hl(null===t||void 0===t||null===(e=t.accounts)||void 0===e?void 0:e.rows)}catch(l){(0,g.LY)(l)}})(),(async()=>{try{var e;let l={page:1,limit:1e3};const{data:t}=await z.A.getTax(l);console.log(null===t||void 0===t||null===(e=t.accounts)||void 0===e?void 0:e.rows),Il(null===t||void 0===t?void 0:t.tax)}catch(l){(0,g.LY)(l)}})(),(async()=>{try{let e={page:1,limit:1e3};const{data:l}=await y.A.getCategoryList(e);Wl(null===l||void 0===l?void 0:l.categories)}catch(e){(0,g.LY)(e)}})(),(async()=>{try{let e={page:1,limit:1e3};const{data:l}=await y.A.getServiceItem(e);Bl(null===l||void 0===l?void 0:l.rows)}catch(e){(0,g.LY)(e)}})(),Zl({id:"walkin",name:"Walk-in Customer"}),ve("customer",{id:"walkin",name:"Walk-in Customer"})}),[]),(0,i.useEffect)((()=>{(async()=>{try{var e,l,t,i,s,n,o,a,d,r;let u={id:ke};const{data:c}=await y.A.getPreSaleDetail(u);console.log(null===c||void 0===c||null===(e=c.receipt)||void 0===e?void 0:e.sale_receipt_items),ve("token",null===c||void 0===c||null===(l=c.receipt)||void 0===l?void 0:l.token_number),J(null===c||void 0===c||null===(t=c.receipt)||void 0===t?void 0:t.sale_receipt_items),Q(null===c||void 0===c||null===(i=c.receipt)||void 0===i?void 0:i.total_amount),al(new Date(null===c||void 0===c||null===(s=c.receipt)||void 0===s?void 0:s.invoice_date)),ve("display_customer",null===c||void 0===c||null===(n=c.receipt)||void 0===n?void 0:n.customer_name),ve("mobile",null===c||void 0===c||null===(o=c.receipt)||void 0===o?void 0:o.customer_mobile),ve("email",null===c||void 0===c||null===(a=c.receipt)||void 0===a?void 0:a.customer_email),ve("ref",null===c||void 0===c||null===(d=c.receipt)||void 0===d?void 0:d.ref),ve("address",null===c||void 0===c||null===(r=c.receipt)||void 0===r?void 0:r.address)}catch(u){console.error("Error fetching location:",u)}})()}),[]),(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(s.A,{sx:{width:"100%"}}),(0,E.jsx)(s.A,{m:3,sx:{backgroundColor:"white",borderRadius:"12px"},children:(0,E.jsxs)(E.Fragment,{children:[(0,E.jsxs)(s.A,{component:"form",onSubmit:ce((async e=>{console.log(e);try{let l={id:ke,token_number:null===e||void 0===e?void 0:e.token,token_date:ol,invoice_prefix:"AAD",cost_center:null===e||void 0===e?void 0:e.cost_center,customer_name:null===e||void 0===e?void 0:e.display_customer,reception_id:null===Jl||void 0===Jl?void 0:Jl.id,customer_mobile:null===e||void 0===e?void 0:e.mobile,customer_email:null===e||void 0===e?void 0:e.email,ref:null===e||void 0===e?void 0:e.ref,total_amount:O,items:Z};console.log(e,"formData");const t=y.A.UpdateSaleReceipt(l);(0,f.y8)(t,"Saving...","Added Successfully","Something Went Wrong");const i=await t;200===(null===i||void 0===i?void 0:i.responseCode)&&N("/pre-sales")}catch(l){(0,g.LY)(l)}})),children:[(0,E.jsx)(s.A,{sx:{display:"flex",justifyContent:"space-between",gap:"10px",p:3,alignItems:"flex-end"},children:(0,E.jsx)(n.A,{sx:{fontSize:"22px",fontWeight:"bold"},children:"Update Al-ADHEED"})}),(0,E.jsx)(s.A,{sx:{p:3},children:(0,E.jsxs)(o.Ay,{container:!0,sx:{gap:"5px 25px"},children:[(0,E.jsx)(o.Ay,{item:!0,xs:12,children:(0,E.jsxs)(o.Ay,{container:!0,gap:2,children:[(0,E.jsx)(o.Ay,{item:!0,md:3,sm:12,xs:12,children:(0,E.jsx)(S.A,{label:"Token",size:"small",disabled:!0,placeholder:"Enter Token",register:ue("token"),InputProps:{endAdornment:(0,E.jsx)(a.A,{onClick:()=>Xl(),children:(0,E.jsx)(D.A,{sx:{color:"#bd9b4a"}})})}})}),(0,E.jsx)(o.Ay,{item:!0,md:3,sm:12,xs:12,children:(0,E.jsx)(S.A,{label:"Invoice Number",size:"small",disabled:!0,placeholder:"Invoice Number",register:ue("invoicenumber"),InputProps:{endAdornment:(0,E.jsx)(a.A,{onClick:()=>Xl(!0),children:(0,E.jsx)(D.A,{sx:{color:"#bd9b4a"}})})}})})]})}),(0,E.jsx)(o.Ay,{item:!0,md:5.5,sm:12,xs:12,sx:{border:"2px solid black",p:2,borderRadius:"15px"},children:(0,E.jsxs)(o.Ay,{container:!0,sx:{gap:"5px 25px"},children:[(0,E.jsx)(o.Ay,{item:!0,xs:5.7,children:(0,E.jsx)(j.A,{label:"Invoice Date :*",value:ol,size:"small",disabled:!0,error:null===pe||void 0===pe||null===(e=pe.date)||void 0===e?void 0:e.message,register:ue("date",{required:!ol&&"please enter  date."}),onChange:e=>{ve("date",e),al(new Date(e))}})}),(0,E.jsx)(o.Ay,{item:!0,xs:5.7,children:(0,E.jsx)(b.A,{size:"small",label:"Customer *:",disabled:!0,options:[{id:"walkin",name:"Walk-in Customer"}],selected:Ql,onSelect:e=>{Zl(e)},error:null===pe||void 0===pe||null===(l=pe.customer)||void 0===l?void 0:l.message,register:ue("customer",{required:!1})})})]})}),(0,E.jsx)(o.Ay,{item:!0,md:5.5,sm:12,xs:12,sx:{border:"2px solid black",p:2,borderRadius:"15px",mt:{md:0,sm:2,xs:2}},children:(0,E.jsxs)(o.Ay,{container:!0,sx:{gap:"5px 25px"},children:[(0,E.jsx)(o.Ay,{item:!0,md:5.7,sm:12,xs:12,children:(0,E.jsx)(S.A,{label:"Display Customer",size:"small",placeholder:"Walk-in Customer",register:ue("display_customer",{required:"please enter display name."}),error:null===pe||void 0===pe||null===(t=pe.display_customer)||void 0===t?void 0:t.message})}),(0,E.jsx)(o.Ay,{item:!0,md:5.7,sm:12,xs:12,children:(0,E.jsx)(S.A,{label:"Mobile",size:"small",placeholder:"Mobile No",register:ue("mobile",{required:"please enter mobile ."}),error:null===pe||void 0===pe||null===(_=pe.display_customer)||void 0===_?void 0:_.message})}),(0,E.jsx)(o.Ay,{item:!0,md:5.7,sm:12,xs:12,children:(0,E.jsx)(S.A,{label:"Email",size:"small",placeholder:"Email",register:ue("email",{required:"please enter email ."}),error:null===pe||void 0===pe||null===(I=pe.email)||void 0===I?void 0:I.message})}),(0,E.jsx)(o.Ay,{item:!0,md:5.7,sm:12,xs:12,children:(0,E.jsx)(S.A,{label:"TRN",size:"small",placeholder:"TRN",register:ue("trn",{required:"please enter trn ."}),error:null===pe||void 0===pe||null===(T=pe.trn)||void 0===T?void 0:T.message})}),(0,E.jsx)(o.Ay,{item:!0,md:5.7,sm:12,xs:12,children:(0,E.jsx)(S.A,{label:"Ref",size:"small",placeholder:"Reference",register:ue("ref")})}),(0,E.jsx)(o.Ay,{item:!0,md:5.7,sm:12,xs:12,children:(0,E.jsx)(b.A,{label:"Cost Center",size:"small",options:[{id:"Al-ADHEED",name:"Al-ADHEED"}],selected:he("cost_center"),onSelect:e=>ve("cost_center",e),register:ue("cost_center",{required:"please enter cost center ."}),error:null===pe||void 0===pe||null===(q=pe.cost_center)||void 0===q?void 0:q.message})}),(0,E.jsx)(o.Ay,{item:!0,md:5.7,sm:12,xs:12,children:(0,E.jsx)(S.A,{label:"Address",size:"small",placeholder:"Address",multiline:!0,rows:2,register:ue("address",{required:"please enter address ."}),error:null===pe||void 0===pe||null===(R=pe.address)||void 0===R?void 0:R.message})})]})}),(0,E.jsx)(o.Ay,{item:!0,xs:12,display:"flex",justifyContent:"flex-end",children:(0,E.jsx)(p.A,{type:"submit",disabled:0==(null===Z||void 0===Z?void 0:Z.length),variant:"contained",sx:{textTransform:"capitalize",backgroundColor:"#bd9b4a",":hover":{backgroundColor:"rgb(189 155 74)"}},children:"Update"})})]})})]}),(0,E.jsx)("form",{onSubmit:se($?e=>{const l={...e,service:Gl};J((e=>e.map((e=>e.id===l.id?l:e)))),de(),Ol(null)}:e=>{console.log(Gl);const l={...e,service:Gl};J((e=>{const t=[...e,l],i=t.reduce(((e,l)=>e+l.total),0);return Q(i),t})),de(),Ol("")}),children:(0,E.jsx)(d.A,{component:r.A,children:(0,E.jsxs)(u.A,{children:[(0,E.jsx)(c.A,{children:(0,E.jsxs)(v.A,{children:[(0,E.jsx)(m.A,{sx:{width:"150px"},children:"Item Code"}),(0,E.jsx)(m.A,{sx:{width:"400px"},children:"Service"}),(0,E.jsx)(m.A,{sx:{width:"150px"},children:"Qty"}),(0,E.jsx)(m.A,{sx:{width:"150px"},children:"Govt fee"}),(0,E.jsx)(m.A,{sx:{width:"150px"},children:"Center fee"}),(0,E.jsx)(m.A,{sx:{width:"150px"},children:"Bank Charge"}),(0,E.jsx)(m.A,{sx:{width:"150px"},children:"Total"}),(0,E.jsx)(m.A,{sx:{width:"150px"},children:"Action"})]})}),(0,E.jsxs)(x.A,{children:[(null===Z||void 0===Z?void 0:Z.length)>0&&(null===Z||void 0===Z?void 0:Z.map(((e,l)=>{var t;return(0,E.jsxs)(v.A,{children:[(0,E.jsx)(m.A,{children:null===e||void 0===e?void 0:e.id}),(0,E.jsx)(m.A,{children:null===e||void 0===e||null===(t=e.service)||void 0===t?void 0:t.name}),(0,E.jsx)(m.A,{children:null===e||void 0===e?void 0:e.quantity}),(0,E.jsx)(m.A,{children:null===e||void 0===e?void 0:e.govt_fee}),(0,E.jsx)(m.A,{children:null===e||void 0===e?void 0:e.center_fee}),(0,E.jsx)(m.A,{children:null===e||void 0===e?void 0:e.bank_charge}),(0,E.jsx)(m.A,{children:null===e||void 0===e?void 0:e.total})]},l)}))),(0,E.jsxs)(v.A,{children:[(0,E.jsx)(m.A,{colSpan:7,align:"right",children:(0,E.jsx)(n.A,{variant:"h6",sx:{fontSize:"15px"},children:"Sub-total:"})}),(0,E.jsxs)(m.A,{children:[(0,E.jsx)(n.A,{variant:"h6",sx:{fontSize:"15px"},children:O})," "]})]}),(0,E.jsxs)(v.A,{children:[(0,E.jsx)(m.A,{colSpan:7,align:"right",children:(0,E.jsx)(n.A,{variant:"h6",sx:{fontSize:"15px"},children:"Amount Total:"})}),(0,E.jsxs)(m.A,{children:[(0,E.jsx)(n.A,{variant:"h6",sx:{fontSize:"15px"},children:O})," "]})]})]})]})})})]})})]})}},66360:(e,l,t)=>{var i=t(24994);l.A=void 0;var s=i(t(40039)),n=t(70579);l.A=(0,s.default)((0,n.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search")}}]);
//# sourceMappingURL=1562.737cddf2.chunk.js.map