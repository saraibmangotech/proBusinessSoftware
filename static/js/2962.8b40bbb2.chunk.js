"use strict";(self.webpackChunkgalaxy_web=self.webpackChunkgalaxy_web||[]).push([[2962],{82962:(e,t,s)=>{s.r(t),s.d(t,{default:()=>X});var l=s(65043),i=s(28076),n=s(39652),o=s(77502),a=s(96446),d=s(68903),r=s(85865),c=s(79650),u=s(63336),m=s(71806),p=s(84882),x=s(73460),v=s(54620),h=s(45903),g=s(73216),y=s(77020),A=s(23602),j=s(44563),f=(s(36838),s(42165),s(66535),s(85900)),S=s(83992),b=s(91395),C=s(22030),w=s(20566),k=s(24858),N=s(79456),F=s(4841),_=s(29542),z=s(91284),D=s(37230),E=(s(72450),s(86005)),P=s(86178),q=s.n(P),R=(s(54667),s(99543)),T=s(95692),V=s(87383),W=s(93445),B=s(70255),M=(s(21727),s(18285),s(88073)),U=s(50857),Y=s(23768),I=s(19668),L=s(28153),$=s(51593),J=s(70579);const K=(0,h.A)(i.A)((e=>{let{theme:t}=e;return{border:0}})),H=(0,h.A)(n.A)((e=>{let{theme:t}=e;return{[`&.${o.A.head}`]:{fontSize:14,fontFamily:"Public Sans",border:"1px solid #EEEEEE",padding:"15px",textAlign:"left",whiteSpace:"nowrap",color:"#434343",paddingRight:"50px",background:"transparent",fontWeight:"bold"},[`&.${o.A.body}`]:{fontSize:14,fontFamily:"Public Sans",textWrap:"nowrap",padding:"5px !important",paddingLeft:"15px !important",".MuiBox-root":{display:"flex",gap:"6px",alignItems:"center",justifyContent:"center",".MuiBox-root":{cursor:"pointer"}},svg:{width:"auto",height:"24px"},".MuiTypography-root":{textTransform:"capitalize",fontFamily:v.ay.NunitoRegular,textWrap:"nowrap"},".MuiButtonBase-root":{padding:"8px",width:"28px",height:"28px"}}}})),Q=(0,S.A)({loaderWrap:{display:"flex",height:100,"& svg":{width:"40px !important",height:"40px !important"}}});const X=function(){var e,t,s,i,n,o,h;const S=["text/csv"],{register:P,handleSubmit:X,getValues:O,setValue:Z,formState:{errors:G}}=(0,k.mN)(),{register:ee,handleSubmit:te,setValue:se,getValues:le,formState:{errors:ie}}=(0,k.mN)(),{register:ne,handleSubmit:oe,setValue:ae,getValues:de,formState:{errors:re}}=(0,k.mN)(),ce=(0,g.Zp)(),ue=(Q(),(0,N.wA)()),me=(0,l.useRef)(null),[pe,xe]=(0,l.useState)(!1),[ve,he]=(0,l.useState)(!1),[ge,ye]=(0,l.useState)([]),[Ae,je]=(0,l.useState)(!1),[fe,Se]=(0,l.useState)("asc"),{user:be,userLogout:Ce}=(0,I.A)(),[we,ke]=(0,l.useState)([]),[Ne,Fe]=(0,l.useState)(0),[_e,ze]=(0,l.useState)(50),[De,Ee]=(0,l.useState)(1),[Pe,qe]=(0,l.useState)(null),[Re,Te]=(0,l.useState)(),[Ve,We]=(0,l.useState)(),[Be,Me]=(0,l.useState)(null),[Ue,Ye]=(0,l.useState)(null),[Ie,Le]=(0,l.useState)([]),[$e,Je]=(0,l.useState)(!1),[Ke,He]=(0,l.useState)(null),[Qe,Xe]=(0,l.useState)(),[Oe,Ze]=(0,l.useState)(null),[Ge,et]=(0,l.useState)(0),[tt,st]=(0,l.useState)(0),[lt,it]=(0,l.useState)(),[nt,ot]=(0,l.useState)(),[at,dt]=(0,l.useState)(),[rt,ct]=(0,l.useState)(),[ut,mt]=(0,l.useState)(!1),[pt,xt]=(0,l.useState)(!1),[vt,ht]=(0,l.useState)(null),[gt,yt]=(0,l.useState)({}),[At,jt]=(0,l.useState)(),[ft,St]=(0,l.useState)(!1),bt=async(e,t,s)=>{try{const l=e||De,i=t||_e,n=s?{...gt,...s}:null;Ee(l),ze(i),yt(n);let o={page:l,limit:i,is_draft:!0,customer_id:"C"==(null===be||void 0===be?void 0:be.user_type)?null===be||void 0===be?void 0:be.customer_id:null};o={...o,...n};const{data:a}=await V.A.getVisaRequestList(o);ye(null===a||void 0===a?void 0:a.rows),Fe(null===a||void 0===a?void 0:a.count),console.log((0,C.TJ)(null===a||void 0===a?void 0:a.permissions)),jt((0,C.TJ)(null===a||void 0===a?void 0:a.permissions)),jt((0,C.TJ)(null===a||void 0===a?void 0:a.permissions)),null===a||void 0===a||a.permissions.forEach((e=>{null!==e&&void 0!==e&&e.route&&null!==e&&void 0!==e&&e.identifier&&null!==e&&void 0!==e&&e.permitted&&ue((0,F.Ft)(null===e||void 0===e?void 0:e.route))}))}catch(l){(0,T.Ni)(l)}};return(0,l.useEffect)((()=>{bt(),(async()=>{try{const{data:e}=await B.A.getBanks();Le(null===e||void 0===e?void 0:e.banks)}catch(e){(0,T.Ni)(e)}})(),(async(e,t,s)=>{try{const l=e||De,i=t||_e,n={...gt,...s};Ee(l),ze(i),yt(n);let o={page:l,limit:i};o={...o,...n};const{data:a}=await f.A.getCustomerQueue(o);ke(null===a||void 0===a?void 0:a.rows)}catch(l){(0,T.Ni)(l)}})()}),[]),(0,J.jsxs)(a.A,{sx:{p:3},children:[(0,J.jsx)($.A,{open:pt,onClose:()=>xt(!1),message:"Are You Sure?",action:()=>{xt(!1),(async()=>{console.log(vt);try{let e={id:null===vt||void 0===vt?void 0:vt.id};const{message:t}=await f.A.handleDeleteDraft(e);(0,j.ee)(t),bt()}catch(e){(0,T.Ni)(e)}})()}}),(0,J.jsx)(_.A,{open:$e,onClose:()=>{Je(!1),Xe(!1),Ze(null)},title:"Upload Excel",children:(0,J.jsx)(a.A,{component:"form",onSubmit:oe((async()=>{mt(!0),(async()=>{et(0);let e=at;try{const l=new FormData;l.append("file",lt),l.append("id",null===Oe||void 0===Oe?void 0:Oe.id),console.log(lt);let i=10485760;if(lt.size>i)(0,T.Ni)("File Size Must Be Less than 3 MB");else{const{data:i}=await M.A.post(U.A.uploadCVSDraft,l,{onUploadProgress:e=>{const t=e.loaded,s=Math.round(100*t/e.total);et(s),console.log((0,C.KU)(t)),st((0,C.KU)(t)),Y.Ay.success(" Successfully Updated!"),Je(!1),Xe(!1),mt(!1),Ze(null)}});var t,s;if(i)return e[0].isUpload=!0,e[0].file=null===i||void 0===i||null===(t=i.data)||void 0===t?void 0:t.nations,console.log(i,"asddasasd"),null===i||void 0===i||null===(s=i.data)||void 0===s?void 0:s.path}}catch(l){(0,T.Ni)(l)}})()})),children:(0,J.jsxs)(d.Ay,{container:!0,spacing:2,children:[(0,J.jsx)(d.Ay,{item:!0,xs:12,children:(0,J.jsx)(D.A,{size:"small",label:"Select Customer :",options:we,selected:Oe,onSelect:e=>{Ze(e),ae("customer",e)},error:null===re||void 0===re||null===(e=re.customer)||void 0===e?void 0:e.message,register:ne("customer",{required:"Please select customer account."})})}),(0,J.jsxs)(d.Ay,{item:!0,xs:5,children:[(0,J.jsx)(r.A,{sx:{fontSize:"18px",fontWeight:"bold",color:y.A.gray,mt:1},children:"Upload CSV :* "}),(0,J.jsx)(L.A,{Memo:!0,accept:S,error:null===re||void 0===re||null===(t=re.excel)||void 0===t?void 0:t.message,register:ne("excel",{required:"Please upload  excel   .",onChange:async e=>{(async e=>{try{const t=e.target;e.preventDefault();const s=e.target.files[0];let l=[{name:null===s||void 0===s?void 0:s.name,file:"",type:null===s||void 0===s?void 0:s.type.split("/")[1],size:(0,C.KU)(s.size),isUpload:!1}];S.includes(s.type)?(it(s),dt(l),Xe(s)):(t.value="",it(""),dt([]),Xe(""),(0,T.Ni)(`Only ${(0,C.zc)(S)} formats is supported`))}catch(t){(0,T.Ni)(t)}})(e);const t=e.target.files[0];console.log(t),ot(null===t||void 0===t?void 0:t.name),Xe(t)}})}),console.log(null===Qe||void 0===Qe?void 0:Qe.name,"asdasdasdasd"),(null===Qe||void 0===Qe?void 0:Qe.name)&&(0,J.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,J.jsx)(a.A,{component:"img",src:v.To.uploadXls,width:"50px"}),(0,J.jsx)("span",{style:{color:"blue"},children:nt})," "]})]}),(0,J.jsx)(d.Ay,{container:!0,sx:{justifyContent:"center"},children:(0,J.jsxs)(d.Ay,{item:!0,xs:6,sm:6,sx:{mt:2,display:"flex",justifyContent:"space-between",gap:"25px"},children:[(0,J.jsx)(z.jn,{disabled:ut,bgcolor:y.A.primary,title:"Yes,Confirm",type:"submit"}),(0,J.jsx)(z.jn,{onClick:()=>{Je(!1),Xe(!1),Ze(null)},bgcolor:"#FF1F25",title:"No,Cancel"})]})})]})})}),(0,J.jsx)(_.A,{open:pe,onClose:()=>xe(!1),title:"Change Status?",children:(0,J.jsx)(a.A,{component:"form",onSubmit:X((async()=>{try{let e={status:Ve.id?"approved":"rejected",visa_id:null===Pe||void 0===Pe?void 0:Pe.id};const t=V.A.updateStatus(e);console.log(t),(0,T.y8)(t,"Saving...","Added Successfully","Something Went Wrong");const s=await t;200===(null===s||void 0===s?void 0:s.responseCode)&&(xe(!1),bt())}catch(e){console.log(e)}})),children:(0,J.jsxs)(d.Ay,{container:!0,spacing:2,children:[(0,J.jsx)(d.Ay,{item:!0,xs:12,sm:12,children:(0,J.jsx)(D.A,{size:"small",label:"Select Status :",options:[{id:!1,name:"rejected"},{id:!0,name:"approved"}],selected:Ve,onSelect:e=>{We(e)},error:null===G||void 0===G||null===(s=G.status)||void 0===s?void 0:s.message,register:P("status",{required:"Please select status."})})}),(0,J.jsx)(d.Ay,{container:!0,sx:{justifyContent:"center"},children:(0,J.jsxs)(d.Ay,{item:!0,xs:6,sm:6,sx:{mt:2,display:"flex",justifyContent:"space-between",gap:"25px"},children:[(0,J.jsx)(z.jn,{bgcolor:y.A.primary,title:"Yes,Confirm",type:"submit"}),(0,J.jsx)(z.jn,{onClick:()=>xe(!1),bgcolor:"#FF1F25",title:"No,Cancel"})]})})]})})}),(0,J.jsx)(_.A,{open:ve,onClose:()=>he(!1),title:"Change Payment Status?",children:(0,J.jsx)(a.A,{component:"form",onSubmit:te((async e=>{try{let t={payment_date:Be,payment_type:null===Ue||void 0===Ue?void 0:Ue.name,visa_id:null===Pe||void 0===Pe?void 0:Pe.id,amount:null===e||void 0===e?void 0:e.amount,bank_id:null===Ke||void 0===Ke?void 0:Ke.id,description:null===e||void 0===e?void 0:e.description};const s=V.A.updatePaymentStatus(t);console.log(s),(0,T.y8)(s,"Saving...","Added Successfully","Something Went Wrong");const l=await s;200===(null===l||void 0===l?void 0:l.responseCode)&&(he(!1),bt())}catch(t){console.log(t)}})),children:(0,J.jsxs)(d.Ay,{container:!0,children:[(0,J.jsx)(d.Ay,{item:!0,xs:12,sm:12,children:(0,J.jsx)(W.A,{label:"Payment Date :",value:Be,size:"small",error:null===ie||void 0===ie||null===(i=ie.date)||void 0===i?void 0:i.message,register:ee("date",{required:"Please enter  date."}),onChange:e=>{(e=>{try{if("Invalid Date"==e)return void Me("invalid");Me(new Date(e))}catch(t){(0,j.LY)(t)}})(e),se("date",e)}})}),(0,J.jsx)(d.Ay,{item:!0,xs:12,sm:12,children:(0,J.jsx)(D.A,{size:"small",label:"Payment Type :",options:[{id:"cash",name:"Cash"},{id:"bank",name:"Bank"},{id:"cheque",name:"Cheque"}],selected:Ue,onSelect:e=>{Ye(e)},error:null===ie||void 0===ie||null===(n=ie.status)||void 0===n?void 0:n.message,register:ee("status",{required:"Please select status."})})}),(0,J.jsx)(d.Ay,{item:!0,xs:12,sm:12,children:(0,J.jsx)(D.A,{size:"small",label:"Bank :",options:Ie,selected:Ke,onSelect:e=>{He(e)},error:null===ie||void 0===ie||null===(o=ie.banks)||void 0===o?void 0:o.message,register:ee("bank",{required:"Please select bank."})})}),(0,J.jsx)(d.Ay,{item:!0,xs:12,sm:12,children:(0,J.jsx)(R.A,{label:"Amount : ",StartLabel:"AED",register:ee("amount",{required:"Enter year inside rate"})})}),(0,J.jsx)(d.Ay,{item:!0,xs:12,sm:12,children:(0,J.jsx)(w.A,{label:"Description :",size:"small",rows:5,placeholder:"Description",error:null===ie||void 0===ie||null===(h=ie.description)||void 0===h?void 0:h.message,register:ee("description",{required:!1})})}),(0,J.jsx)(d.Ay,{container:!0,sx:{justifyContent:"center"},children:(0,J.jsxs)(d.Ay,{item:!0,xs:6,sm:6,sx:{mt:2,display:"flex",justifyContent:"space-between",gap:"25px"},children:[(0,J.jsx)(z.jn,{bgcolor:y.A.primary,title:"Yes,Confirm",type:"submit"}),(0,J.jsx)(z.jn,{onClick:()=>he(!1),bgcolor:"#FF1F25",title:"No,Cancel"})]})})]})})}),(0,J.jsx)(a.A,{sx:{display:"flex",justifyContent:"space-between",mb:2},children:(0,J.jsx)(r.A,{sx:{fontSize:"24px",fontWeight:"bold"},children:"Draft Visa Request"})}),(0,J.jsxs)(a.A,{children:[(0,J.jsxs)(d.Ay,{container:!0,spacing:2,children:[(0,J.jsx)(d.Ay,{item:!0,xs:6,children:(0,J.jsx)(R.A,{type:"text",bgcolor:"#FAFAFA",color:y.A.primary,border:"3px solid #FAFAFA",StartLabel:"Search",placeholder:"Search",register:P("search")})}),(0,J.jsxs)(d.Ay,{item:!0,xs:6,display:"flex",justifyContent:"flex-end",gap:2,children:[(0,J.jsx)(z.jn,{bgcolor:"#0076bf",textcolor:y.A.white,title:"Reset",onClick:()=>{Z("search",""),bt(1,"",null)},loading:ft}),(0,J.jsx)(z.jn,{bgcolor:"#bd9b4a",title:"Search",onClick:()=>(()=>{let e={search:O("search")};(0,C.S$)((()=>bt(1,"",e)))})(),loading:ft})]})]}),(0,J.jsx)(d.Ay,{item:!0,md:11,children:ge&&(0,J.jsxs)(a.A,{children:[(0,J.jsx)(d.Ay,{container:!0,mb:2}),ge&&(0,J.jsxs)(l.Fragment,{children:[(0,J.jsx)(E.X,{ref:me,landscape:!0,paperSize:"A4",margin:5,fileName:"Import Customers",children:(0,J.jsx)(c.A,{component:u.A,sx:{maxHeight:"calc(100vh - 200px)",mt:5,backgroundColor:"transparent",boxShadow:"none !important",borderRadius:"0px !important"},children:(0,J.jsxs)(m.A,{stickyHeader:!0,sx:{minWidth:500},children:[(0,J.jsx)(p.A,{children:(0,J.jsx)(K,{children:[{name:"SR No.",key:""},{name:"Date",key:"created_at"},{name:"Customer",key:"created_at"},{name:"Visa Quantity",key:"commission_visa"},{name:"Total Amount",key:"commission_monthly"},{name:"Deposit Balance",key:"customerCount"},{name:"Status",key:""},{name:"Actions",key:""}].map(((e,t)=>(0,J.jsx)(H,{style:{textAlign:"SR No."==(null===e||void 0===e?void 0:e.name)?"center":"left",paddingRight:"SR No."==(null===e||void 0===e?void 0:e.name)?"15px":"50px"},className:"pdf-table",children:(0,J.jsxs)(a.A,{sx:{display:"flex",alignItems:"flex-end"},children:[null===e||void 0===e?void 0:e.name," ","Date"==(null===e||void 0===e?void 0:e.name)&&(0,J.jsxs)(J.Fragment,{children:["\xa0",(0,J.jsx)("span",{style:{height:"20px",cursor:"pointer"},children:(0,J.jsx)(a.A,{component:"img",onClick:()=>{Se("asc"==fe?"desc":"asc"),(e=>{let t={sort_by:e,sort_order:fe};(0,C.S$)((()=>bt(1,"",t)))})(null===e||void 0===e?void 0:e.key)},src:v.To.sortIcon,width:"18px"})})]})]})},t)))})}),(0,J.jsx)(x.A,{children:null===ge||void 0===ge?void 0:ge.map(((e,t)=>{var s,l;return(0,J.jsxs)(K,{sx:{border:"1px solid #EEEEEE !important"},children:[(0,J.jsx)(H,{style:{textAlign:"left"},className:"pdf-table",children:null===e||void 0===e?void 0:e.id}),(0,J.jsx)(H,{style:{textAlign:"left"},className:"pdf-table",children:q()(null===e||void 0===e?void 0:e.created_at).format("MM-DD-YYYY")}),(0,J.jsx)(H,{style:{textAlign:"left"},className:"pdf-table",children:null===e||void 0===e||null===(s=e.customer)||void 0===s?void 0:s.name}),(0,J.jsx)(H,{style:{textAlign:"left"},className:"pdf-table",children:null===e||void 0===e?void 0:e.candidates_count}),(0,J.jsx)(H,{style:{textAlign:"left"},className:"pdf-table",children:null===e||void 0===e?void 0:e.total_visa_charges}),(0,J.jsx)(H,{style:{textAlign:"left"},className:"pdf-table",children:null===e||void 0===e||null===(l=e.customer)||void 0===l?void 0:l.deposit_balance}),(0,J.jsx)(H,{style:{textAlign:"left"},className:"pdf-table",children:(0,J.jsx)(a.A,{component:"div",sx:{cursor:"pointer"},children:"Draft"})}),(0,J.jsx)(H,{style:{textAlign:"left"},className:"pdf-table",children:(0,J.jsxs)(a.A,{sx:{display:"flex",gap:2},children:[(0,J.jsx)(a.A,{children:(null===At||void 0===At?void 0:At.details)&&(0,J.jsx)(a.A,{component:"img",src:v.To.detailIcon,onClick:()=>ce(`/draft-detail/${null===e||void 0===e?void 0:e.id}`),width:"35px"})}),(0,J.jsx)(a.A,{children:(null===At||void 0===At?void 0:At.delete)&&(0,J.jsx)(a.A,{component:"img",src:v.To.deleteIcon,onClick:()=>{ht(e),xt(!0)},width:"35px"})})]})})]},t)}))})]})})}),(0,J.jsx)(b.A,{currentPage:De,pageSize:_e,onPageSizeChange:e=>bt(1,e.target.value),tableCount:null===we||void 0===we?void 0:we.length,totalCount:Ne,onPageChange:e=>bt(e,"")})]}),Ae&&(0,J.jsx)(A.$,{})]})})]})]})}}}]);
//# sourceMappingURL=2962.8b40bbb2.chunk.js.map